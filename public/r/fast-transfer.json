{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "fast-transfer",
  "type": "registry:component",
  "title": "Fast Transfer",
  "description": "A simple component built with Nexus to enable cross chain transfer",
  "dependencies": [
    "@avail-project/nexus-core@1.0.0-beta.56",
    "@radix-ui/react-accordion",
    "@radix-ui/react-dialog",
    "@radix-ui/react-label",
    "@radix-ui/react-select",
    "@radix-ui/react-slot",
    "@radix-ui/react-tooltip",
    "class-variance-authority",
    "clsx",
    "lucide-react",
    "tailwind-merge"
  ],
  "registryDependencies": [
    "https://elements.nexus.availproject.org/r/accordion.json",
    "https://elements.nexus.availproject.org/r/button.json",
    "https://elements.nexus.availproject.org/r/card.json",
    "https://elements.nexus.availproject.org/r/dialog.json",
    "https://elements.nexus.availproject.org/r/input.json",
    "https://elements.nexus.availproject.org/r/label.json",
    "https://elements.nexus.availproject.org/r/select.json",
    "https://elements.nexus.availproject.org/r/skeleton.json",
    "https://elements.nexus.availproject.org/r/tooltip.json",
    "https://elements.nexus.availproject.org/r/nexus-provider.json",
    "https://elements.nexus.availproject.org/r/utils.json",
    "https://elements.nexus.availproject.org/r/badge.json",
    "https://elements.nexus.availproject.org/r/separator.json"
  ],
  "files": [
    {
      "path": "registry/nexus-elements/transfer/transfer.tsx",
      "content": "\"use client\";\nimport { type FC } from \"react\";\nimport { Card, CardContent } from \"../ui/card\";\nimport ChainSelect from \"./components/chain-select\";\nimport TokenSelect from \"./components/token-select\";\nimport { Button } from \"../ui/button\";\nimport { LoaderPinwheel, X } from \"lucide-react\";\nimport { useNexus } from \"../nexus/NexusProvider\";\nimport AmountInput from \"./components/amount-input\";\nimport FeeBreakdown from \"./components/fee-breakdown\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"../ui/dialog\";\nimport TransactionProgress from \"./components/transaction-progress\";\nimport SourceBreakdown from \"./components/source-breakdown\";\nimport {\n  type SUPPORTED_CHAINS_IDS,\n  type SUPPORTED_TOKENS,\n} from \"@avail-project/nexus-core\";\nimport { type Address } from \"viem\";\nimport { Skeleton } from \"../ui/skeleton\";\nimport RecipientAddress from \"./components/recipient-address\";\nimport useTransfer from \"./hooks/useTransfer\";\nimport AllowanceModal from \"./components/allowance-modal\";\nimport ViewHistory from \"../view-history/view-history\";\n\ninterface FastTransferProps {\n  prefill?: {\n    token: SUPPORTED_TOKENS;\n    chainId: SUPPORTED_CHAINS_IDS;\n    amount?: string;\n    recipient?: Address;\n  };\n  onComplete?: () => void;\n  onStart?: () => void;\n  onError?: (message: string) => void;\n}\n\nconst FastTransfer: FC<FastTransferProps> = ({\n  onComplete,\n  onStart,\n  onError,\n  prefill,\n}) => {\n  const {\n    nexusSDK,\n    intent,\n    bridgableBalance,\n    fetchBridgableBalance,\n    allowance,\n    network,\n  } = useNexus();\n\n  const {\n    inputs,\n    setInputs,\n    timer,\n    loading,\n    refreshing,\n    isDialogOpen,\n    txError,\n    setTxError,\n    handleTransaction,\n    reset,\n    filteredBridgableBalance,\n    startTransaction,\n    setIsDialogOpen,\n    commitAmount,\n    lastExplorerUrl,\n    steps,\n    status,\n  } = useTransfer({\n    prefill,\n    network: network ?? \"mainnet\",\n    nexusSDK,\n    intent,\n    bridgableBalance,\n    onComplete,\n    onStart,\n    onError,\n    allowance,\n    fetchBalance: fetchBridgableBalance,\n  });\n  return (\n    <Card className=\"w-full max-w-xl\">\n      <CardContent className=\"flex flex-col gap-y-4 w-full px-2 sm:px-6\">\n        <ViewHistory className=\"absolute -top-2 right-3\" />\n        <ChainSelect\n          selectedChain={inputs?.chain}\n          handleSelect={(chain) =>\n            setInputs({\n              ...inputs,\n              chain,\n            })\n          }\n          label=\"To\"\n          disabled={!!prefill?.chainId}\n        />\n        <TokenSelect\n          selectedChain={inputs?.chain}\n          selectedToken={inputs?.token}\n          handleTokenSelect={(token) => setInputs({ ...inputs, token })}\n          disabled={!!prefill?.token}\n        />\n        <AmountInput\n          amount={inputs?.amount}\n          onChange={(amount) => setInputs({ ...inputs, amount })}\n          bridgableBalance={filteredBridgableBalance}\n          onCommit={() => void commitAmount()}\n          disabled={refreshing || !!prefill?.amount}\n          inputs={inputs}\n        />\n        <RecipientAddress\n          address={inputs?.recipient}\n          onChange={(address) =>\n            setInputs({ ...inputs, recipient: address as `0x${string}` })\n          }\n          disabled={!!prefill?.recipient}\n        />\n        {intent?.current?.intent && (\n          <>\n            <SourceBreakdown\n              intent={intent?.current?.intent}\n              tokenSymbol={filteredBridgableBalance?.symbol as SUPPORTED_TOKENS}\n              isLoading={refreshing}\n              chain={inputs?.chain}\n              bridgableBalance={filteredBridgableBalance}\n              requiredAmount={inputs?.amount}\n            />\n            <div className=\"w-full flex items-start justify-between gap-x-4\">\n              <p className=\"text-base font-semibold\">Receipient Receives</p>\n              <div className=\"flex flex-col gap-y-1 min-w-fit\">\n                {refreshing ? (\n                  <Skeleton className=\"h-5 w-28\" />\n                ) : (\n                  <p className=\"text-base font-semibold text-right\">\n                    {inputs?.amount} {filteredBridgableBalance?.symbol}\n                  </p>\n                )}\n                {refreshing ? (\n                  <Skeleton className=\"h-4 w-36\" />\n                ) : (\n                  <p className=\"text-sm font-medium text-right\">\n                    on {intent?.current?.intent?.destination?.chainName}\n                  </p>\n                )}\n              </div>\n            </div>\n            <FeeBreakdown\n              intent={intent?.current?.intent}\n              isLoading={refreshing}\n            />\n          </>\n        )}\n\n        {!intent.current && (\n          <Button\n            onClick={handleTransaction}\n            disabled={\n              !inputs?.amount ||\n              !inputs?.recipient ||\n              !inputs?.chain ||\n              !inputs?.token ||\n              loading\n            }\n          >\n            {loading ? (\n              <LoaderPinwheel className=\"animate-spin size-5\" />\n            ) : (\n              \"Transfer to recipient\"\n            )}\n          </Button>\n        )}\n\n        <Dialog\n          open={isDialogOpen}\n          onOpenChange={(open) => {\n            if (loading) return;\n            setIsDialogOpen(open);\n          }}\n        >\n          {intent.current && !isDialogOpen && (\n            <div className=\"w-full flex items-center gap-x-2 justify-between\">\n              <Button variant={\"destructive\"} onClick={reset} className=\"w-1/2\">\n                Deny\n              </Button>\n              <DialogTrigger asChild>\n                <Button\n                  onClick={startTransaction}\n                  className=\"w-1/2\"\n                  disabled={refreshing}\n                >\n                  {refreshing ? \"Refreshing...\" : \"Accept\"}\n                </Button>\n              </DialogTrigger>\n            </div>\n          )}\n\n          <DialogContent>\n            <DialogHeader className=\"sr-only\">\n              <DialogTitle>Transaction Progress</DialogTitle>\n            </DialogHeader>\n            {allowance.current ? (\n              <AllowanceModal\n                allowance={allowance}\n                callback={startTransaction}\n                onCloseCallback={reset}\n              />\n            ) : (\n              <TransactionProgress\n                timer={timer}\n                steps={steps}\n                viewIntentUrl={lastExplorerUrl}\n                operationType={\"transfer\"}\n                completed={status === \"success\"}\n              />\n            )}\n          </DialogContent>\n        </Dialog>\n\n        {txError && (\n          <div className=\"rounded-md border border-destructive bg-destructive/80 px-3 py-2 text-sm text-destructive-foreground flex items-start justify-between gap-x-3 mt-3 w-full max-w-md\">\n            <span className=\"flex-1 w-full truncate\">{txError}</span>\n            <Button\n              type=\"button\"\n              size={\"icon\"}\n              variant={\"ghost\"}\n              onClick={() => {\n                reset();\n                setTxError(null);\n              }}\n              className=\"text-destructive-foreground/80 hover:text-destructive-foreground focus:outline-none\"\n              aria-label=\"Dismiss error\"\n            >\n              <X className=\"size-4\" />\n            </Button>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default FastTransfer;\n",
      "type": "registry:component",
      "target": "components/transfer/transfer.tsx"
    },
    {
      "path": "registry/nexus-elements/view-history/view-history.tsx",
      "content": "\"use client\";\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTrigger,\n  DialogTitle,\n} from \"@/registry/nexus-elements/ui/dialog\";\nimport { Clock, LoaderPinwheel, SquareArrowOutUpRight } from \"lucide-react\";\nimport { TOKEN_METADATA, type RFF } from \"@avail-project/nexus-core\";\nimport { cn } from \"@/lib/utils\";\nimport { Badge } from \"@/registry/nexus-elements/ui/badge\";\nimport { Button } from \"@/registry/nexus-elements/ui/button\";\nimport { Card } from \"@/registry/nexus-elements/ui/card\";\nimport { Separator } from \"@/registry/nexus-elements/ui/separator\";\nimport useViewHistory from \"./hooks/useViewHistory\";\n\nconst SourceChains = ({ sources }: { sources: RFF[\"sources\"] }) => {\n  return (\n    <div className=\"flex items-center\">\n      {sources.map((source, index) => (\n        <div\n          key={source.chain.id}\n          className={cn(\n            \"rounded-full transition-transform hover:scale-110\",\n            index > 0 && \"-ml-2\"\n          )}\n          style={{ zIndex: sources.length - index }}\n        >\n          <img\n            src={source.chain.logo}\n            alt={source.chain.name}\n            width={24}\n            height={24}\n            className=\"rounded-full\"\n          />\n        </div>\n      ))}\n    </div>\n  );\n};\n\nconst StatusBadge = ({ status }: { status: string }) => {\n  const getVariant = (status: string) => {\n    if (status === \"Fulfilled\") {\n      return \"default\";\n    } else if (status === \"Deposited\") {\n      return \"secondary\";\n    } else if (status === \"Refunded\") {\n      return \"outline\";\n    } else if (status === \"Failed\") {\n      return \"destructive\";\n    } else {\n      return \"default\";\n    }\n  };\n\n  return (\n    <Badge variant={getVariant(status)} className=\"px-3 py-1\">\n      <p className=\"text-xs font-semibold tracking-wide\">{status}</p>\n    </Badge>\n  );\n};\n\nconst DestinationToken = ({\n  destination,\n}: {\n  destination: RFF[\"destinations\"];\n}) => {\n  return (\n    <div className=\"flex items-center\">\n      {destination.map((dest, index) => (\n        <div\n          key={dest.token.symbol}\n          className={cn(\n            \"rounded-full transition-transform hover:scale-110\",\n            index > 0 && \"-ml-2\"\n          )}\n          style={{ zIndex: destination.length - index }}\n        >\n          <img\n            src={TOKEN_METADATA[dest.token.symbol].icon || \"/placeholder.svg\"}\n            alt={TOKEN_METADATA[dest.token.symbol].name}\n            width={24}\n            height={24}\n            className=\"rounded-full\"\n          />\n        </div>\n      ))}\n    </div>\n  );\n};\n\nconst ViewHistory = ({\n  viewAsModal = true,\n  className,\n}: {\n  viewAsModal?: boolean;\n  className?: string;\n}) => {\n  const {\n    history,\n    displayedHistory,\n    hasMore,\n    isLoadingMore,\n    getStatus,\n    observerTarget,\n    ITEMS_PER_PAGE,\n    formatExpiryDate,\n  } = useViewHistory();\n\n  const renderHistoryContent = () => {\n    if (displayedHistory.length > 0) {\n      return (\n        <>\n          {displayedHistory.map((pastIntent) => (\n            <Card\n              key={pastIntent.id}\n              className=\"p-4 hover:shadow-md transition-shadow duration-200 border-border/50 gap-3\"\n            >\n              <div className=\"flex items-start justify-between gap-4\">\n                <div className=\"flex items-center gap-3\">\n                  <DestinationToken destination={pastIntent.destinations} />\n                  <div className=\"flex flex-col\">\n                    <p className=\"text-sm font-medium\">\n                      {pastIntent.destinations\n                        .map((d) => d.token.symbol)\n                        .join(\", \")}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Intent #{pastIntent.id}\n                    </p>\n                  </div>\n                </div>\n                <StatusBadge status={getStatus(pastIntent)} />\n              </div>\n\n              <Separator className=\"my-1\" />\n\n              <div className=\"flex flex-col sm:flex-row  items-start sm:items-center justify-between gap-4\">\n                <div className=\"flex items-center justify-between gap-x-3 flex-1 w-full sm:min-w-fit\">\n                  <SourceChains sources={pastIntent.sources} />\n                  <div className=\"flex items-center gap-2 text-muted-foreground\">\n                    <div className=\"h-px w-8 bg-border\" />\n                    <span className=\"text-xs\">→</span>\n                    <div className=\"h-px w-8 bg-border\" />\n                  </div>\n                  <div className=\"rounded-full hover:scale-110\">\n                    <img\n                      src={\n                        pastIntent.destinationChain.logo || \"/placeholder.svg\"\n                      }\n                      alt={pastIntent.destinationChain.name}\n                      width={24}\n                      height={24}\n                      className=\"rounded-full\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"flex items-center justify-between sm:justify-end  gap-x-2 w-full\">\n                  <div className=\"text-left sm:text-right\">\n                    <p className=\"text-xs text-muted-foreground\">Expiry</p>\n                    <p className=\"text-xs font-medium\">\n                      {formatExpiryDate(pastIntent.expiry)}\n                    </p>\n                  </div>\n                  <a\n                    href={pastIntent.explorerUrl}\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                  >\n                    <Button variant=\"outline\" size=\"icon\">\n                      <SquareArrowOutUpRight className=\"size-4\" />\n                    </Button>\n                  </a>\n                </div>\n              </div>\n            </Card>\n          ))}\n\n          {hasMore && (\n            <div ref={observerTarget} className=\"flex justify-center py-4\">\n              {isLoadingMore && (\n                <div className=\"flex items-center gap-2 text-muted-foreground\">\n                  <LoaderPinwheel className=\"size-4 animate-spin\" />\n                  <span className=\"text-sm\">Loading more...</span>\n                </div>\n              )}\n            </div>\n          )}\n\n          {!hasMore && displayedHistory.length > ITEMS_PER_PAGE && (\n            <div className=\"flex justify-center py-4\">\n              <p className=\"text-sm text-muted-foreground\">\n                No more transactions to load\n              </p>\n            </div>\n          )}\n        </>\n      );\n    }\n\n    if (history === null) {\n      return (\n        <div className=\"flex flex-col items-center justify-center py-16 gap-4\">\n          <div className=\"relative\">\n            <div className=\"absolute inset-0 bg-primary/10 blur-xl rounded-full\" />\n            <LoaderPinwheel className=\"relative animate-spin size-12 text-primary\" />\n          </div>\n          <div className=\"text-center space-y-1\">\n            <p className=\"text-base font-medium\">Loading your history</p>\n            <p className=\"text-sm text-muted-foreground\">\n              Fetching your past transactions...\n            </p>\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"flex flex-col items-center justify-center py-16 gap-4\">\n        <Clock className=\"size-16 text-muted-foreground/30\" />\n        <div className=\"text-center space-y-1\">\n          <p className=\"text-base font-medium\">No history yet</p>\n          <p className=\"text-sm text-muted-foreground\">\n            Your transaction history will appear here\n          </p>\n        </div>\n      </div>\n    );\n  };\n\n  if (!viewAsModal) {\n    return (\n      <div className=\"flex flex-col gap-y-3 max-h-96 no-scrollbar overflow-y-auto w-full max-w-md\">\n        {renderHistoryContent()}\n      </div>\n    );\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className={cn(\"relative group\", className)}\n        >\n          <Clock className=\"size-5 text-primary transition-transform group-hover:scale-110\" />\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-2xl flex flex-col\">\n        <DialogHeader>\n          <DialogTitle className=\"text-2xl font-semibold\">\n            Transaction History\n          </DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col gap-y-3 max-h-96 no-scrollbar overflow-y-auto w-full\">\n          {renderHistoryContent()}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default ViewHistory;\n",
      "type": "registry:component",
      "target": "components/view-history/view-history.tsx"
    },
    {
      "path": "registry/nexus-elements/view-history/hooks/useViewHistory.ts",
      "content": "import { type RFF } from \"@avail-project/nexus-core\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\nimport { useCallback, useEffect, useState } from \"react\";\n\nconst ITEMS_PER_PAGE = 10;\n\nfunction formatExpiryDate(timestamp: number) {\n  const date = new Date(timestamp * 1000);\n  const formatted = date.toLocaleString(\"en-US\", {\n    month: \"short\",\n    day: \"2-digit\",\n    year: \"numeric\",\n  });\n  return formatted.replace(\" \", \", \");\n}\n\nconst useViewHistory = () => {\n  const { nexusSDK } = useNexus();\n  const [history, setHistory] = useState<RFF[] | null>(null);\n  const [displayedHistory, setDisplayedHistory] = useState<RFF[]>([]);\n  const [page, setPage] = useState(0);\n  const [hasMore, setHasMore] = useState(true);\n  const [isLoadingMore, setIsLoadingMore] = useState(false);\n  const [sentinelNode, setSentinelNode] = useState<HTMLDivElement | null>(null);\n\n  const observerTarget = useCallback((node: HTMLDivElement | null) => {\n    setSentinelNode(node);\n  }, []);\n\n  const fetchIntentHistory = async () => {\n    try {\n      const history = await nexusSDK?.getMyIntents();\n      if (history) {\n        setHistory(history);\n        const firstPage = history.slice(0, ITEMS_PER_PAGE);\n        setDisplayedHistory(firstPage);\n        setHasMore(history.length > ITEMS_PER_PAGE);\n      }\n    } catch (error) {\n      console.error(\"Error fetching intent history:\", error);\n    }\n  };\n\n  useEffect(() => {\n    if (!history) {\n      fetchIntentHistory();\n    }\n  }, [history]);\n\n  const loadMore = useCallback(() => {\n    if (!history || isLoadingMore || !hasMore) return;\n    setIsLoadingMore(true);\n\n    setTimeout(() => {\n      const nextPage = page + 1;\n      const startIndex = nextPage * ITEMS_PER_PAGE;\n      const endIndex = startIndex + ITEMS_PER_PAGE;\n      const newItems = history.slice(startIndex, endIndex);\n\n      if (newItems.length > 0) {\n        setDisplayedHistory((prev) => [...prev, ...newItems]);\n        setPage(nextPage);\n        setHasMore(endIndex < history.length);\n      } else {\n        setHasMore(false);\n      }\n\n      setIsLoadingMore(false);\n    }, 300);\n  }, [history, page, isLoadingMore, hasMore]);\n\n  useEffect(() => {\n    if (!sentinelNode) {\n      return;\n    }\n\n    const rootElement = sentinelNode.parentElement;\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        if (entries[0].isIntersecting && hasMore && !isLoadingMore) {\n          loadMore();\n        }\n      },\n      { threshold: 0.1, root: rootElement ?? null }\n    );\n\n    observer.observe(sentinelNode);\n\n    return () => {\n      observer.disconnect();\n    };\n  }, [sentinelNode, loadMore, hasMore, isLoadingMore, displayedHistory.length]);\n\n  const getStatus = (pastIntent: RFF) => {\n    if (pastIntent?.fulfilled) {\n      return \"Fulfilled\";\n    } else if (pastIntent?.deposited) {\n      return \"Deposited\";\n    } else if (pastIntent?.refunded) {\n      return \"Refunded\";\n    } else {\n      return \"Failed\";\n    }\n  };\n\n  return {\n    history,\n    displayedHistory,\n    page,\n    hasMore,\n    isLoadingMore,\n    getStatus,\n    observerTarget,\n    ITEMS_PER_PAGE,\n    formatExpiryDate,\n  };\n};\n\nexport default useViewHistory;\n",
      "type": "registry:component",
      "target": "components/view-history/hooks/useViewHistory.ts"
    },
    {
      "path": "registry/nexus-elements/common/index.ts",
      "content": "export * from \"./hooks/useStopwatch\";\nexport * from \"./hooks/usePolling\";\nexport * from \"./hooks/useInterval\";\nexport * from \"./hooks/useStableCallback\";\nexport * from \"./hooks/useDebouncedValue\";\nexport * from \"./hooks/useDebouncedCallback\";\nexport * from \"./hooks/useNexusError\";\nexport * from \"./tx/types\";\nexport * from \"./tx/steps\";\nexport * from \"./tx/useTransactionSteps\";\nexport * from \"./utils/constant\";\n",
      "type": "registry:component",
      "target": "components/common/index.ts"
    },
    {
      "path": "registry/nexus-elements/common/utils/constant.ts",
      "content": "import { formatUnits, parseUnits } from \"viem\";\n\nexport const SHORT_CHAIN_NAME: Record<number, string> = {\n  1: \"Ethereum\",\n  8453: \"Base\",\n  42161: \"Arbitrum\",\n  10: \"Optimism\",\n  137: \"Polygon\",\n  43114: \"Avalanche\",\n  534352: \"Scroll\",\n  50104: \"Sophon\",\n  8217: \"Kaia\",\n  56: \"BNB\",\n  143: \"Monad\",\n  999: \"HyperEVM\",\n  728126428: \"Tron\",\n  11155111: \"Sepolia\",\n  84532: \"Base Sepolia\",\n  421614: \"Arbitrum Sepolia\",\n  11155420: \"Optimism Sepolia\",\n  80002: \"Polygon Amoy\",\n  10143: \"Monad Testnet\",\n  2494104990: \"Tron Shasta\",\n  567: \"Validium Testnet\",\n} as const;\n\nconst DEFAULT_SAFETY_MARGIN = 0.01; // 1%\n\n/**\n * Compute an amount string for fraction buttons (25%, 50%, 75%, 100%).\n *\n * @param balanceStr - user's balance as a human decimal string (e.g. \"12.345\") OR as base-unit integer string if `balanceIsBaseUnits` true\n * @param fraction - fraction e.g. 0.25, 0.5, 0.75, 1\n * @param decimals - token decimals (6 for USDC/USDT, 18 for ETH)\n * @param safetyMargin - 0.01 for 1% default\n * @param balanceIsBaseUnits - if true, balanceStr is already base units integer string (wei / smallest unit)\n * @returns decimal string clipped to token decimals (rounded down)\n */\nexport function computeAmountFromFraction(\n  balanceStr: string,\n  fraction: number,\n  decimals: number,\n  safetyMargin = DEFAULT_SAFETY_MARGIN,\n  balanceIsBaseUnits = false\n): string {\n  if (!balanceStr) return \"0\";\n\n  // parse balance into base units (BigInt)\n  const balanceUnits: bigint = balanceIsBaseUnits\n    ? BigInt(balanceStr)\n    : parseUnits(balanceStr, decimals);\n\n  if (balanceUnits === BigInt(0)) return \"0\";\n\n  // Use an integer precision multiplier to avoid FP issues\n  const PREC = 1_000_000; // 1e6 precision for fraction & safety margin\n  const safetyMul = BigInt(Math.max(0, Math.floor((1 - safetyMargin) * PREC))); // (1 - safetyMargin) * PREC\n  const fractionMul = BigInt(Math.max(0, Math.floor(fraction * PREC))); // fraction * PREC\n\n  // Apply safety margin: floor(balance * (1 - safetyMargin))\n  const maxAfterSafety = (balanceUnits * safetyMul) / BigInt(PREC);\n\n  // Apply fraction and floor: floor(maxAfterSafety * fraction)\n  let desiredUnits = (maxAfterSafety * fractionMul) / BigInt(PREC);\n\n  // Extra clamp just in case\n  if (desiredUnits > balanceUnits) desiredUnits = balanceUnits;\n  if (desiredUnits < BigInt(0)) desiredUnits = BigInt(0);\n\n  // format back to human readable decimal string with token decimals (formatUnits truncates/keeps decimals)\n  // formatUnits will produce exactly decimals digits if fractional part exists; we'll strip trailing zeros.\n  const raw = formatUnits(desiredUnits, decimals);\n  // strip trailing zeros and possible trailing dot\n  return raw\n    .replace(/(\\.\\d*?[1-9])0+$/u, \"$1\")\n    .replace(/\\.0+$/u, \"\")\n    .replace(/^\\.$/u, \"0\");\n}\n",
      "type": "registry:component",
      "target": "components/common/utils/constant.ts"
    },
    {
      "path": "registry/nexus-elements/common/hooks/useStableCallback.ts",
      "content": "import { useCallback, useRef } from \"react\";\n\n/**\n * Returns a stable function identity that always calls the latest implementation.\n * Useful when passing callbacks to memoized children without re-creating handlers.\n */\nexport function useStableCallback<Args extends readonly unknown[], Return>(\n  fn: (...args: Args) => Return\n): (...args: Args) => Return {\n  const fnRef = useRef<(...args: Args) => Return>(fn);\n  fnRef.current = fn;\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const stable = useCallback(\n    ((...args: Args) => {\n      return fnRef.current(...args);\n    }) as (...args: Args) => Return,\n    []\n  );\n\n  return stable;\n}\n",
      "type": "registry:component",
      "target": "components/common/hooks/useStableCallback.ts"
    },
    {
      "path": "registry/nexus-elements/common/hooks/useNexusError.ts",
      "content": "import { NexusError } from \"@avail-project/nexus-core\";\n\nfunction handler(err: unknown) {\n  if (err instanceof NexusError) {\n    return {\n      code: err?.code,\n      message: err?.message,\n      context: err?.data?.context,\n      details: err?.data?.details,\n    };\n  } else {\n    console.error(\"Unexpected error:\", err);\n    return {\n      code: \"unexpected_error\",\n      message: \"Oops! Something went wrong. Please try again.\",\n      context: undefined,\n      details: undefined,\n    };\n  }\n}\nexport function useNexusError() {\n  return handler;\n}\n",
      "type": "registry:component",
      "target": "components/common/hooks/useNexusError.ts"
    },
    {
      "path": "registry/nexus-elements/common/hooks/useInterval.ts",
      "content": "import { useEffect, useRef } from \"react\";\nimport { useStableCallback } from \"./useStableCallback\";\n\ninterface UseIntervalOptions {\n  enabled?: boolean;\n  immediate?: boolean;\n}\n\n/**\n * Declarative setInterval with pause/resume and latest-callback semantics.\n * Pass delay=null to pause.\n */\nexport function useInterval(\n  callback: () => void,\n  delay: number | null,\n  options: UseIntervalOptions = {}\n) {\n  const { enabled = true, immediate = false } = options;\n  const savedCallback = useStableCallback(callback);\n  const intervalRef = useRef<NodeJS.Timeout | null>(null);\n\n  useEffect(() => {\n    if (!enabled || delay == null) return;\n    if (immediate) {\n      savedCallback();\n    }\n    intervalRef.current = setInterval(savedCallback, delay);\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n        intervalRef.current = null;\n      }\n    };\n  }, [delay, enabled, immediate, savedCallback]);\n}\n",
      "type": "registry:component",
      "target": "components/common/hooks/useInterval.ts"
    },
    {
      "path": "registry/nexus-elements/common/hooks/useStopwatch.ts",
      "content": "import { useEffect, useRef, useState } from \"react\";\n\ninterface UseStopwatchOptions {\n  running?: boolean;\n  intervalMs?: number;\n}\n\n/**\n * Simple stopwatch that increments elapsed seconds while running.\n * Designed to replace scattered timer effects.\n */\nexport function useStopwatch(options: UseStopwatchOptions = {}) {\n  const { running = false, intervalMs = 100 } = options;\n  const [elapsedSeconds, setElapsedSeconds] = useState(0);\n  const timerRef = useRef<ReturnType<typeof setInterval> | null>(null);\n\n  const reset = () => {\n    setElapsedSeconds(0);\n  };\n\n  const stop = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n  };\n\n  const start = () => {\n    if (timerRef.current) return;\n    timerRef.current = setInterval(() => {\n      // 1s == 1000ms; we add fractional seconds per tick\n      setElapsedSeconds((prev) => prev + intervalMs / 1000);\n    }, intervalMs);\n  };\n\n  useEffect(() => {\n    if (running) {\n      start();\n    } else {\n      stop();\n    }\n    return stop;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [running, intervalMs]);\n\n  return {\n    seconds: elapsedSeconds,\n    start,\n    stop,\n    reset,\n    running: Boolean(timerRef.current),\n  };\n}\n",
      "type": "registry:component",
      "target": "components/common/hooks/useStopwatch.ts"
    },
    {
      "path": "registry/nexus-elements/common/hooks/usePolling.ts",
      "content": "import { useRef } from \"react\";\nimport { useInterval } from \"./useInterval\";\nimport { useStableCallback } from \"./useStableCallback\";\n\n/**\n * Declarative polling with in-flight protection (no overlap).\n * When enabled becomes true, an immediate run is executed,\n * followed by interval-based runs.\n */\nexport function usePolling(\n  enabled: boolean,\n  fn: () => Promise<void> | void,\n  intervalMs: number\n) {\n  const inFlightRef = useRef(false);\n  const wrapped = useStableCallback(async () => {\n    if (inFlightRef.current) return;\n    try {\n      inFlightRef.current = true;\n      await fn();\n    } catch (error) {\n      console.error(error);\n    } finally {\n      inFlightRef.current = false;\n    }\n  });\n\n  useInterval(wrapped, enabled ? intervalMs : null, {\n    enabled,\n    immediate: enabled,\n  });\n}\n",
      "type": "registry:component",
      "target": "components/common/hooks/usePolling.ts"
    },
    {
      "path": "registry/nexus-elements/common/hooks/useDebouncedCallback.ts",
      "content": "import { useEffect, useMemo, useRef } from \"react\";\nimport { useStableCallback } from \"./useStableCallback\";\n\ntype AnyFn = (...args: any[]) => any;\n\nexport interface Debounced<T extends AnyFn> {\n  (...args: Parameters<T>): void;\n  cancel: () => void;\n  flush: () => void;\n}\n\n/**\n * Returns a debounced function that delays invoking `fn` until after `delay`\n * milliseconds have elapsed since the last call.\n */\nexport function useDebouncedCallback<T extends AnyFn>(\n  fn: T,\n  delay: number\n): Debounced<T> {\n  const latest = useStableCallback(fn);\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\n  const lastArgsRef = useRef<Parameters<T> | null>(null);\n\n  const cancel = () => {\n    if (timerRef.current) {\n      clearTimeout(timerRef.current);\n      timerRef.current = null;\n    }\n  };\n\n  const flush = () => {\n    if (timerRef.current && lastArgsRef.current) {\n      clearTimeout(timerRef.current);\n      timerRef.current = null;\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      latest(...lastArgsRef.current);\n      lastArgsRef.current = null;\n    }\n  };\n\n  // cancel when delay changes/unmounts\n  useEffect(() => cancel, [delay]);\n\n  return useMemo(() => {\n    const debounced = ((...args: Parameters<T>) => {\n      lastArgsRef.current = args;\n      cancel();\n      timerRef.current = setTimeout(() => {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        latest(...lastArgsRef.current!);\n        lastArgsRef.current = null;\n        timerRef.current = null;\n      }, delay);\n    }) as Debounced<T>;\n    debounced.cancel = cancel;\n    debounced.flush = flush;\n    return debounced;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [delay, latest]);\n}\n",
      "type": "registry:component",
      "target": "components/common/hooks/useDebouncedCallback.ts"
    },
    {
      "path": "registry/nexus-elements/common/hooks/useDebouncedValue.ts",
      "content": "import { useEffect, useState } from \"react\";\nimport { useDebouncedCallback } from \"./useDebouncedCallback\";\n\n/**\n * Derives a debounced value from an input value and delay.\n */\nexport function useDebouncedValue<T>(value: T, delay: number): T {\n  const [debounced, setDebounced] = useState<T>(value);\n  const setter = useDebouncedCallback((v: T) => setDebounced(v), delay);\n\n  useEffect(() => {\n    setter(value);\n    return setter.cancel;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value, delay]);\n\n  return debounced;\n}\n",
      "type": "registry:component",
      "target": "components/common/hooks/useDebouncedValue.ts"
    },
    {
      "path": "registry/nexus-elements/common/tx/types.ts",
      "content": "export type TransactionStatus =\n  | \"idle\"\n  | \"preview\"\n  | \"awaiting-approval\"\n  | \"executing\"\n  | \"success\"\n  | \"error\";\n\nexport type GenericStep<TStep> = {\n  id: number;\n  completed: boolean;\n  step: TStep;\n};\n\n/**\n * Normalizes a step to a stable key. Prefers typeID, then type, otherwise JSON.\n */\nexport function getStepKey(step: any): string {\n  if (!step) return \"\";\n  if (typeof step.typeID === \"string\" && step.typeID.length > 0) {\n    return step.typeID;\n  }\n  if (typeof step.type === \"string\" && step.type.length > 0) {\n    return step.type;\n  }\n  try {\n    return JSON.stringify(step);\n  } catch {\n    return String(step);\n  }\n}\n",
      "type": "registry:component",
      "target": "components/common/tx/types.ts"
    },
    {
      "path": "registry/nexus-elements/common/tx/steps.ts",
      "content": "import type { SwapStepType } from \"@avail-project/nexus-core\";\nimport type { GenericStep } from \"./types\";\nimport { getStepKey } from \"./types\";\n\n/**\n * Predefined expected steps for swaps to seed UI before events arrive.\n * Kept here to avoid duplication across exact-in and exact-out hooks.\n */\nexport const SWAP_EXPECTED_STEPS: SwapStepType[] = [\n  { type: \"SWAP_START\", typeID: \"SWAP_START\" } as SwapStepType,\n  { type: \"DETERMINING_SWAP\", typeID: \"DETERMINING_SWAP\" } as SwapStepType,\n  {\n    type: \"CREATE_PERMIT_FOR_SOURCE_SWAP\",\n    typeID:\n      \"CREATE_PERMIT_FOR_SOURCE_SWAP\" as unknown as SwapStepType[\"typeID\"],\n  } as SwapStepType,\n  {\n    type: \"SOURCE_SWAP_BATCH_TX\",\n    typeID: \"SOURCE_SWAP_BATCH_TX\",\n  } as SwapStepType,\n  {\n    type: \"SOURCE_SWAP_HASH\",\n    typeID: \"SOURCE_SWAP_HASH\" as unknown as SwapStepType[\"typeID\"],\n  } as SwapStepType,\n  { type: \"RFF_ID\", typeID: \"RFF_ID\" } as SwapStepType,\n  {\n    type: \"DESTINATION_SWAP_BATCH_TX\",\n    typeID: \"DESTINATION_SWAP_BATCH_TX\",\n  } as SwapStepType,\n  {\n    type: \"DESTINATION_SWAP_HASH\",\n    typeID: \"DESTINATION_SWAP_HASH\" as unknown as SwapStepType[\"typeID\"],\n  } as SwapStepType,\n  { type: \"SWAP_COMPLETE\", typeID: \"SWAP_COMPLETE\" } as SwapStepType,\n];\n\nexport function seedSteps<T>(expected: T[]): Array<GenericStep<T>> {\n  return expected.map((st, index) => ({\n    id: index,\n    completed: false,\n    step: st,\n  }));\n}\n\nexport function computeAllCompleted<T>(steps: Array<GenericStep<T>>): boolean {\n  return steps.length > 0 && steps.every((s) => s.completed);\n}\n\n/**\n * Replace the current list of steps with a new list, preserving completion\n * for any steps that were already marked completed (matched by key).\n */\nexport function mergeStepsList<T>(\n  prev: Array<GenericStep<T>>,\n  list: T[]\n): Array<GenericStep<T>> {\n  const completedKeys = new Set<string>();\n  for (const prevStep of prev) {\n    if (prevStep.completed) {\n      completedKeys.add(getStepKey(prevStep.step));\n    }\n  }\n  const next: Array<GenericStep<T>> = [];\n  for (let index = 0; index < list.length; index++) {\n    const step = list[index];\n    const key = getStepKey(step);\n    next.push({\n      id: index,\n      completed: completedKeys.has(key),\n      step,\n    });\n  }\n  return next;\n}\n\n/**\n * Mark a step complete in-place; if the step doesn't yet exist, append it.\n */\nexport function mergeStepComplete<T>(\n  prev: Array<GenericStep<T>>,\n  step: T\n): Array<GenericStep<T>> {\n  const key = getStepKey(step);\n  const updated: Array<GenericStep<T>> = [];\n  let found = false;\n  for (const s of prev) {\n    if (getStepKey(s.step) === key) {\n      updated.push({ ...s, completed: true, step: { ...s.step, ...step } });\n      found = true;\n    } else {\n      updated.push(s);\n    }\n  }\n  if (!found) {\n    updated.push({\n      id: updated.length,\n      completed: true,\n      step,\n    });\n  }\n  return updated;\n}\n",
      "type": "registry:component",
      "target": "components/common/tx/steps.ts"
    },
    {
      "path": "registry/nexus-elements/common/tx/useTransactionSteps.ts",
      "content": "import { useMemo, useRef, useState } from \"react\";\nimport type { GenericStep } from \"./types\";\nimport { getStepKey } from \"./types\";\nimport {\n  computeAllCompleted,\n  mergeStepComplete,\n  mergeStepsList,\n  seedSteps,\n} from \"./steps\";\n\ninterface UseTransactionStepsOptions<T> {\n  expected?: T[];\n}\n\n/**\n * Manages transaction steps with utilities to seed from expected steps,\n * replace the list on \"steps list\" events, and mark individual steps complete.\n */\nexport function useTransactionSteps<\n  T extends { typeID?: string; type?: string }\n>(options: UseTransactionStepsOptions<T> = {}) {\n  const { expected } = options;\n  const [steps, setSteps] = useState<Array<GenericStep<T>>>(() =>\n    expected ? seedSteps(expected) : []\n  );\n  const lastSignatureRef = useRef<string>(\"\");\n\n  const onStepsList = (list: T[]) => {\n    const signature = list.map((step) => getStepKey(step)).join(\"|\");\n    if (lastSignatureRef.current === signature) {\n      setSteps((prev) => mergeStepsList(prev, list));\n      return;\n    }\n    lastSignatureRef.current = signature;\n    setSteps((prev) => mergeStepsList(prev, list));\n  };\n\n  const onStepComplete = (step: T) => {\n    setSteps((prev) => mergeStepComplete(prev, step));\n  };\n\n  const seed = (expectedSteps: T[]) => {\n    setSteps(seedSteps(expectedSteps));\n  };\n\n  const reset = () => {\n    setSteps(expected ? seedSteps(expected) : []);\n    lastSignatureRef.current = \"\";\n  };\n\n  const allCompleted = useMemo(() => computeAllCompleted(steps), [steps]);\n\n  return {\n    steps,\n    allCompleted,\n    onStepsList,\n    onStepComplete,\n    seed,\n    reset,\n  };\n}\n",
      "type": "registry:component",
      "target": "components/common/tx/useTransactionSteps.ts"
    },
    {
      "path": "registry/nexus-elements/transfer/components/allowance-modal.tsx",
      "content": "\"use client\";\nimport React, {\n  type FC,\n  memo,\n  type RefObject,\n  useEffect,\n  useMemo,\n  useState,\n} from \"react\";\nimport { Button } from \"../../ui/button\";\nimport { Input } from \"../../ui/input\";\nimport { Label } from \"../../ui/label\";\nimport {\n  type AllowanceHookSource,\n  CHAIN_METADATA,\n  type OnAllowanceHookData,\n} from \"@avail-project/nexus-core\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\n\ninterface AllowanceModalProps {\n  allowance: RefObject<OnAllowanceHookData | null>;\n  callback?: () => void;\n  onCloseCallback?: () => void;\n}\n\ntype AllowanceChoice = \"min\" | \"max\" | \"custom\";\n\ninterface AllowanceOptionProps {\n  index: number;\n  name: string;\n  choice: AllowanceChoice;\n  selectedChoice?: AllowanceChoice;\n  onSelect: (index: number, choice: AllowanceChoice) => void;\n  title: string;\n  description?: string;\n  children?: React.ReactNode;\n  allowanceValue?: string;\n}\n\nconst ALLOWANCE_CHOICES: Array<{\n  choice: AllowanceChoice;\n  title: string;\n  description: string;\n}> = [\n  {\n    choice: \"min\",\n    title: \"Minimum\",\n    description: \"Grant the lowest allowance required for this action.\",\n  },\n  {\n    choice: \"max\",\n    title: \"Maximum\",\n    description: \"Approve once and skip future approvals for this token.\",\n  },\n  {\n    choice: \"custom\",\n    title: \"Custom amount\",\n    description: \"Specify an allowance that fits your threshold.\",\n  },\n];\n\nconst AllowanceOption: FC<AllowanceOptionProps> = ({\n  index,\n  name,\n  choice,\n  selectedChoice,\n  onSelect,\n  title,\n  description,\n  children,\n  allowanceValue,\n}) => {\n  const isActive = selectedChoice === choice;\n\n  return (\n    <Label className=\"block cursor-pointer\">\n      <input\n        type=\"radio\"\n        name={name}\n        value={choice}\n        checked={isActive}\n        onChange={() => onSelect(index, choice)}\n        className=\"peer sr-only\"\n      />\n      <div className=\"flex flex-col gap-3 rounded-xl border border-border/40 bg-background/40 px-4 py-3 transition peer-focus-visible:outline-none peer-focus-visible:ring-2 peer-focus-visible:ring-primary/50 peer-checked:border-primary peer-checked:bg-primary/10 sm:flex-row sm:items-center sm:justify-between\">\n        <div className=\"flex items-center justify-between w-full\">\n          <div>\n            <p className=\"text-sm font-medium leading-tight\">{title}</p>\n            {description ? (\n              <p className=\"text-xs text-muted-foreground\">{description}</p>\n            ) : null}\n          </div>\n          {allowanceValue && (\n            <p className=\"text-sm font-medium leading-tight\">\n              {allowanceValue}\n            </p>\n          )}\n        </div>\n\n        {children}\n      </div>\n    </Label>\n  );\n};\n\nconst AllowanceModal: FC<AllowanceModalProps> = ({\n  allowance,\n  callback,\n  onCloseCallback,\n}) => {\n  const { nexusSDK } = useNexus();\n  const [selectedOption, setSelectedOption] = useState<AllowanceChoice[]>([]);\n  const [customValues, setCustomValues] = useState<string[]>([]);\n\n  const { sources, allow, deny } = allowance.current ?? {\n    sources: [],\n    allow: () => {},\n    deny: () => {},\n  };\n\n  const defaultChoices = useMemo<AllowanceChoice[]>(\n    () => Array.from({ length: sources.length }, () => \"min\"),\n    [sources.length]\n  );\n\n  const isCustomValueValid = (\n    value: string,\n    minimumRaw: bigint,\n    decimals: number\n  ): boolean => {\n    if (!value || value.trim() === \"\") return false;\n    try {\n      const parsedValue = nexusSDK?.utils?.parseUnits(value, decimals);\n      if (parsedValue === undefined) return false;\n      return parsedValue >= minimumRaw;\n    } catch {\n      return false;\n    }\n  };\n\n  const hasValidationErrors = useMemo(() => {\n    return sources.some((source, index) => {\n      if (selectedOption[index] !== \"custom\") return false;\n      const value = customValues[index];\n      if (!value || value.trim() === \"\") return false;\n      return !isCustomValueValid(\n        value,\n        source.allowance.minimumRaw,\n        source.token.decimals\n      );\n    });\n  }, [sources, selectedOption, customValues]);\n\n  const onClose = () => {\n    deny();\n    allowance.current = null;\n    onCloseCallback?.();\n  };\n\n  const onApprove = () => {\n    const processed = sources.map((_, i) => {\n      const opt = selectedOption[i];\n      if (opt === \"min\" || opt === \"max\") return opt;\n      const rawValue = customValues[i]?.trim();\n      if (!rawValue) return \"min\";\n      const parsed = Number(rawValue);\n      if (!Number.isFinite(parsed) || parsed < 0) return \"min\";\n      return rawValue;\n    });\n    try {\n      allow(processed);\n      allowance.current = null;\n      callback?.();\n    } catch (error) {\n      console.error(\"AllowanceModal onApprove error\", error);\n      allowance.current = null;\n      onCloseCallback?.();\n    }\n  };\n\n  const handleChoiceChange = (index: number, value: AllowanceChoice) => {\n    setSelectedOption((prev) => {\n      const next = [...(prev.length ? prev : defaultChoices)];\n      next[index] = value;\n      return next;\n    });\n  };\n\n  const formatAmount = (value: string | bigint, source: AllowanceHookSource) =>\n    nexusSDK?.utils?.formatTokenBalance(value, {\n      symbol: source.token.symbol,\n      decimals: source.token.decimals,\n    }) ?? \"—\";\n\n  useEffect(() => {\n    setSelectedOption(defaultChoices);\n  }, [defaultChoices]);\n\n  useEffect(() => {\n    setCustomValues(Array.from({ length: sources.length }, () => \"\"));\n  }, [sources.length]);\n\n  return (\n    <>\n      <div className=\"space-y-1\">\n        <p className=\"text-lg font-semibold tracking-tight\">\n          Set Token Allowances\n        </p>\n        <p className=\"text-sm text-muted-foreground\">\n          Review every required token and choose the minimum, an unlimited max,\n          or define a custom amount before approving.\n        </p>\n      </div>\n\n      <div className=\"space-y-4 py-2 max-h-[60vh] overflow-y-auto pr-1\">\n        {sources?.map((source: AllowanceHookSource, index: number) => (\n          <div\n            key={`${source.token.symbol}-${index}`}\n            className=\"rounded-2xl border border-border/40 bg-muted/10 p-4 shadow-sm transition hover:border-border\"\n          >\n            <div className=\"flex flex-wrap items-center justify-between gap-3\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-full bg-background shadow-inner\">\n                  <img\n                    src={CHAIN_METADATA[source.chain.id]?.logo}\n                    alt={source.chain.name}\n                    width={24}\n                    height={24}\n                    className=\"rounded-full\"\n                  />\n                </div>\n                <div>\n                  <p className=\"text-base font-semibold\">\n                    {source.token.symbol}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    {source.chain.name}\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"text-right\">\n                <p className=\"text-xs uppercase tracking-wide text-muted-foreground\">\n                  Current allowance\n                </p>\n                <p className=\"text-sm font-semibold\">\n                  {formatAmount(source.allowance.currentRaw, source)}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"mt-4 space-y-2\">\n              {ALLOWANCE_CHOICES.map((choice) => {\n                if (choice.choice === \"custom\") {\n                  const customValue = customValues[index] ?? \"\";\n                  const isCustomSelected = selectedOption[index] === \"custom\";\n                  const showError =\n                    isCustomSelected &&\n                    customValue.trim() !== \"\" &&\n                    !isCustomValueValid(\n                      customValue,\n                      source.allowance.minimumRaw,\n                      source.token.decimals\n                    );\n                  return (\n                    <AllowanceOption\n                      key={choice.choice}\n                      index={index}\n                      name={`allowance-${index}`}\n                      choice={choice.choice}\n                      selectedChoice={selectedOption[index]}\n                      onSelect={handleChoiceChange}\n                      title={choice.title}\n                      description={choice.description}\n                    >\n                      <div className=\"flex flex-col gap-1\">\n                        <Input\n                          type=\"number\"\n                          step=\"any\"\n                          min=\"0\"\n                          inputMode=\"decimal\"\n                          placeholder=\"0.00\"\n                          value={isCustomSelected ? customValue : \"\"}\n                          onChange={(e) => {\n                            const next = [...customValues];\n                            next[index] = e.target.value;\n                            setCustomValues(next);\n                          }}\n                          maxLength={source.token.decimals}\n                          className={`h-9 w-40 rounded-lg border bg-background/80 text-sm disabled:opacity-60 ${\n                            showError ? \"border-destructive\" : \"\"\n                          }`}\n                          disabled={!isCustomSelected}\n                        />\n                        {showError && (\n                          <p className=\"text-xs text-destructive\">\n                            Min: {source.allowance.minimum}\n                          </p>\n                        )}\n                      </div>\n                    </AllowanceOption>\n                  );\n                }\n                return (\n                  <AllowanceOption\n                    key={choice.choice}\n                    index={index}\n                    name={`allowance-${index}`}\n                    choice={choice.choice}\n                    selectedChoice={selectedOption[index]}\n                    onSelect={handleChoiceChange}\n                    title={choice.title}\n                    description={choice.description}\n                    allowanceValue={\n                      choice.choice === \"min\"\n                        ? formatAmount(source.allowance.minimumRaw, source)\n                        : \"Unlimited\"\n                    }\n                  />\n                );\n              })}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"mt-4 flex flex-col-reverse gap-3 sm:flex-row sm:items-center sm:justify-end\">\n        <Button variant=\"ghost\" onClick={onClose} className=\"font-semibold\">\n          Deny\n        </Button>\n        <Button\n          onClick={onApprove}\n          className=\"w-full sm:w-auto font-semibold\"\n          disabled={hasValidationErrors}\n        >\n          Approve Selected\n        </Button>\n      </div>\n    </>\n  );\n};\n\nAllowanceModal.displayName = \"AllowanceModal\";\n\nexport default memo(AllowanceModal);\n",
      "type": "registry:component",
      "target": "components/transfer/components/allowance-modal.tsx"
    },
    {
      "path": "registry/nexus-elements/transfer/components/amount-input.tsx",
      "content": "import { type FC, Fragment, useEffect, useRef } from \"react\";\nimport { Input } from \"../../ui/input\";\nimport { Button } from \"../../ui/button\";\nimport { type UserAsset } from \"@avail-project/nexus-core\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\nimport { type FastTransferState } from \"../hooks/useTransfer\";\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"../../ui/accordion\";\nimport { SHORT_CHAIN_NAME } from \"../../common\";\nimport { LoaderCircle } from \"lucide-react\";\n\ninterface AmountInputProps {\n  amount?: string;\n  onChange: (value: string) => void;\n  bridgableBalance?: UserAsset;\n  onCommit?: (value: string) => void;\n  disabled?: boolean;\n  inputs: FastTransferState;\n}\n\nconst AmountInput: FC<AmountInputProps> = ({\n  amount,\n  onChange,\n  bridgableBalance,\n  onCommit,\n  disabled,\n  inputs,\n}) => {\n  const { nexusSDK, loading } = useNexus();\n  const commitTimerRef = useRef<NodeJS.Timeout | null>(null);\n\n  const scheduleCommit = (val: string) => {\n    if (!onCommit || disabled) return;\n    if (commitTimerRef.current) clearTimeout(commitTimerRef.current);\n    commitTimerRef.current = setTimeout(() => {\n      onCommit(val);\n    }, 800);\n  };\n\n  const onMaxClick = async () => {\n    if (!nexusSDK || !inputs) return;\n    const maxBalAvailable = await nexusSDK?.calculateMaxForBridge({\n      token: inputs?.token,\n      toChainId: inputs?.chain,\n      recipient: inputs?.recipient,\n    });\n    if (!maxBalAvailable) return;\n    onChange(maxBalAvailable.amount);\n    onCommit?.(maxBalAvailable.amount);\n  };\n\n  useEffect(() => {\n    return () => {\n      if (commitTimerRef.current) {\n        clearTimeout(commitTimerRef.current);\n        commitTimerRef.current = null;\n      }\n    };\n  }, []);\n\n  return (\n    <div className=\"flex flex-col gap-y-2 pb-2 w-full\">\n      <div className=\"w-full flex sm:flex-row flex-col border border-border rounded-lg gap-y-2\">\n        <Input\n          type=\"text\"\n          inputMode=\"decimal\"\n          value={amount ?? \"\"}\n          placeholder=\"Enter Amount\"\n          onChange={(e) => {\n            let next = e.target.value.replaceAll(/[^0-9.]/g, \"\");\n            const parts = next.split(\".\");\n            if (parts.length > 2)\n              next = parts[0] + \".\" + parts.slice(1).join(\"\");\n            if (next === \".\") next = \"0.\";\n            onChange(next);\n            scheduleCommit(next);\n          }}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\") {\n              if (commitTimerRef.current) {\n                clearTimeout(commitTimerRef.current);\n                commitTimerRef.current = null;\n              }\n              onCommit?.(amount ?? \"\");\n            }\n          }}\n          className=\"w-full border-none bg-transparent rounded-r-none focus-visible:ring-0 focus-visible:ring-offset-0 shadow-none py-0 px-3 h-12!\"\n          aria-invalid={Boolean(amount) && Number.isNaN(Number(amount))}\n          disabled={disabled || loading}\n        />\n        <div className=\"flex items-center justify-end-safe gap-x-2 sm:gap-x-4 w-fit px-2 border-l border-border\">\n          {bridgableBalance && (\n            <p className=\"text-base font-medium min-w-max\">\n              {nexusSDK?.utils?.formatTokenBalance(bridgableBalance?.balance, {\n                symbol: bridgableBalance?.symbol,\n                decimals: bridgableBalance?.decimals,\n              })}\n            </p>\n          )}\n          {loading && !bridgableBalance && (\n            <LoaderCircle className=\"size-4 animate-spin\" />\n          )}\n          <Button\n            size={\"sm\"}\n            variant={\"ghost\"}\n            onClick={onMaxClick}\n            className=\"px-0 font-medium\"\n            disabled={disabled}\n          >\n            MAX\n          </Button>\n        </div>\n      </div>\n      <Accordion type=\"single\" collapsible className=\"w-full\">\n        <AccordionItem value=\"balance-breakdown\">\n          <AccordionTrigger\n            className=\"w-fit justify-end items-center py-0 mt-2 gap-x-0.5 cursor-pointer text-sm font-normal\"\n            hideChevron={false}\n          >\n            View Balance Breakdown\n          </AccordionTrigger>\n          <AccordionContent className=\"pb-0 bg-muted rounded-lg mt-4\">\n            <div className=\"space-y-1 py-2\">\n              {bridgableBalance?.breakdown.map((chain) => {\n                if (Number.parseFloat(chain.balance) === 0) return null;\n                return (\n                  <Fragment key={chain.chain.id}>\n                    <div className=\"flex items-center justify-between px-2 py-1 rounded-md\">\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"relative h-6 w-6\">\n                          <img\n                            src={chain?.chain?.logo}\n                            alt={chain.chain.name}\n                            className=\"rounded-full\"\n                            loading=\"lazy\"\n                            decoding=\"async\"\n                            sizes=\"100%\"\n                            width=\"20\"\n                            height=\"20\"\n                          />\n                        </div>\n                        <span className=\"text-sm font-light sm:block hidden\">\n                          {SHORT_CHAIN_NAME[chain.chain.id]}\n                        </span>\n                      </div>\n                      <p className=\"text-sm font-light text-right\">\n                        {nexusSDK?.utils?.formatTokenBalance(chain.balance, {\n                          symbol: bridgableBalance?.symbol,\n                          decimals: bridgableBalance?.decimals,\n                        })}\n                      </p>\n                    </div>\n                  </Fragment>\n                );\n              })}\n            </div>\n          </AccordionContent>\n        </AccordionItem>\n      </Accordion>\n    </div>\n  );\n};\n\nexport default AmountInput;\n",
      "type": "registry:component",
      "target": "components/transfer/components/amount-input.tsx"
    },
    {
      "path": "registry/nexus-elements/transfer/components/source-breakdown.tsx",
      "content": "import {\n  CHAIN_METADATA,\n  type ReadableIntent,\n  type SUPPORTED_CHAINS_IDS,\n  type SUPPORTED_TOKENS,\n  type UserAsset,\n} from \"@avail-project/nexus-core\";\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"../../ui/accordion\";\nimport { Skeleton } from \"../../ui/skeleton\";\nimport { useMemo } from \"react\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\n\ninterface SourceBreakdownProps {\n  intent?: ReadableIntent;\n  tokenSymbol: SUPPORTED_TOKENS;\n  isLoading?: boolean;\n  chain?: SUPPORTED_CHAINS_IDS;\n  bridgableBalance?: UserAsset;\n  requiredAmount?: string;\n}\n\nconst SourceBreakdown = ({\n  intent,\n  tokenSymbol,\n  isLoading = false,\n  chain,\n  bridgableBalance,\n  requiredAmount,\n}: SourceBreakdownProps) => {\n  const { nexusSDK } = useNexus();\n\n  const fundsOnDestination = useMemo(() => {\n    if (!bridgableBalance || !chain) return 0;\n    return Number.parseFloat(\n      bridgableBalance?.breakdown?.find((b) => b.chain?.id === chain)\n        ?.balance ?? \"0\"\n    );\n  }, [bridgableBalance, chain]);\n\n  const spendOnSources = useMemo(() => {\n    if (!intent || (intent?.sources?.length ?? 0) < 2)\n      return `1 asset on 1 chain`;\n    return `${intent?.sources?.length} Assets on ${intent?.sources?.length} chains`;\n  }, [intent]);\n\n  const amountSpend = useMemo(() => {\n    const base = Number(requiredAmount ?? \"0\");\n    if (!intent) return base;\n    const fees = Number.parseFloat(intent?.fees?.total ?? \"0\");\n    return base + fees;\n  }, [requiredAmount, intent]);\n\n  const displaySources = useMemo(() => {\n    if (!intent) {\n      return [\n        {\n          chainID: chain as number,\n          chainLogo: chain ? CHAIN_METADATA[chain]?.logo : undefined,\n          chainName: chain\n            ? CHAIN_METADATA[chain]?.name ?? \"Destination\"\n            : \"Destination\",\n          amount: requiredAmount ?? \"0\",\n          contractAddress: \"\" as `0x${string}`,\n        },\n      ];\n    }\n    const baseSources = intent?.sources ?? [];\n    const requiredAmountNumber = Number(requiredAmount ?? \"0\");\n    const destUsed = Math.max(\n      Math.min(requiredAmountNumber, fundsOnDestination),\n      0\n    );\n    if (destUsed <= 0 || !chain) {\n      return baseSources;\n    }\n    const allSources = intent?.allSources ?? [];\n    const destDetails = allSources?.find?.((s) => s?.chainID === chain);\n    const hasDest = baseSources?.some?.((s) => s?.chainID === chain);\n    const destSource = {\n      chainID: chain,\n      chainLogo: destDetails?.chainLogo,\n      chainName: destDetails?.chainName ?? \"Destination\",\n      amount: destUsed.toString(),\n      contractAddress: (destDetails?.contractAddress ?? \"\") as `0x${string}`,\n    };\n    if (hasDest) {\n      return baseSources.map((s) =>\n        s?.chainID === chain ? { ...s, amount: destSource.amount } : s\n      );\n    }\n    return [...baseSources, destSource];\n  }, [intent, requiredAmount, fundsOnDestination, chain]);\n\n  return (\n    <Accordion type=\"single\" collapsible className=\"w-full\">\n      <AccordionItem value=\"sources\">\n        <div className=\"flex items-start justify-between gap-x-4 w-full\">\n          {isLoading ? (\n            <>\n              <div className=\"flex flex-col items-start gap-y-1 min-w-fit\">\n                <p className=\"text-base font-light\">You Spend</p>\n                <Skeleton className=\"h-4 w-44\" />\n              </div>\n              <div className=\"flex flex-col items-end gap-y-1 min-w-fit\">\n                <Skeleton className=\"h-5 w-24\" />\n                <div className=\"w-fit\">\n                  <Skeleton className=\"h-4 w-24\" />\n                </div>\n              </div>\n            </>\n          ) : (\n            displaySources && (\n              <>\n                <div className=\"flex flex-col items-start gap-y-1 min-w-fit\">\n                  <p className=\"text-base font-light\">You Spend</p>\n                  <p className=\"text-sm font-light\">{spendOnSources}</p>\n                </div>\n\n                <div className=\"flex flex-col items-end gap-y-1 min-w-fit\">\n                  <p className=\"text-base font-light\">\n                    {nexusSDK?.utils?.formatTokenBalance(amountSpend, {\n                      symbol: tokenSymbol,\n                      decimals: intent?.token?.decimals,\n                    })}\n                  </p>\n\n                  <AccordionTrigger\n                    containerClassName=\"w-fit\"\n                    className=\"py-0 items-center gap-x-1\"\n                    hideChevron={false}\n                  >\n                    <p className=\"text-sm font-medium\">View Sources</p>\n                  </AccordionTrigger>\n                </div>\n              </>\n            )\n          )}\n        </div>\n        {!isLoading && displaySources?.length > 0 && (\n          <AccordionContent className=\"my-4 bg-muted pb-0 px-4 py-2 rounded-lg w-full\">\n            <div className=\"flex flex-col items-center gap-y-3\">\n              {displaySources?.map((source) => (\n                <div\n                  key={source.chainID}\n                  className=\"flex items-center justify-between w-full gap-x-2\"\n                >\n                  <div className=\"flex items-center gap-x-2\">\n                    <img\n                      src={source?.chainLogo}\n                      alt={source?.chainName}\n                      width={20}\n                      height={20}\n                      className=\"rounded-full\"\n                    />\n                    <p className=\"text-sm font-light\">{source.chainName}</p>\n                  </div>\n\n                  <p className=\"text-sm font-light\">\n                    {nexusSDK?.utils?.formatTokenBalance(source.amount, {\n                      symbol: tokenSymbol,\n                      decimals: intent?.token?.decimals,\n                    })}\n                  </p>\n                </div>\n              ))}\n            </div>\n          </AccordionContent>\n        )}\n      </AccordionItem>\n    </Accordion>\n  );\n};\n\nexport default SourceBreakdown;\n",
      "type": "registry:component",
      "target": "components/transfer/components/source-breakdown.tsx"
    },
    {
      "path": "registry/nexus-elements/transfer/components/chain-select.tsx",
      "content": "import { type FC, useMemo } from \"react\";\nimport { Label } from \"../../ui/label\";\nimport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"../../ui/select\";\nimport { type SUPPORTED_CHAINS_IDS } from \"@avail-project/nexus-core\";\nimport { cn } from \"@/lib/utils\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\n\ninterface ChainSelectProps {\n  selectedChain: number;\n  disabled?: boolean;\n  hidden?: boolean;\n  className?: string;\n  label?: string;\n  handleSelect: (chainId: SUPPORTED_CHAINS_IDS) => void;\n}\n\nconst ChainSelect: FC<ChainSelectProps> = ({\n  selectedChain,\n  disabled,\n  hidden = false,\n  className,\n  label,\n  handleSelect,\n}) => {\n  const { supportedChainsAndTokens } = useNexus();\n  const selectedChainData = useMemo(() => {\n    if (!supportedChainsAndTokens) return null;\n    return supportedChainsAndTokens.find((c) => c.id === selectedChain);\n  }, [selectedChain, supportedChainsAndTokens]);\n\n  if (hidden) return null;\n  return (\n    <Select\n      value={selectedChain?.toString() ?? \"\"}\n      onValueChange={(value) => {\n        if (!disabled) {\n          handleSelect(Number.parseInt(value) as SUPPORTED_CHAINS_IDS);\n        }\n      }}\n    >\n      <div className=\"flex flex-col items-start gap-y-3 w-full\">\n        {label && <Label className=\"text-sm font-semibold\">{label}</Label>}\n        <SelectTrigger\n          disabled={disabled}\n          className=\"h-12! w-full text-base font-light\"\n        >\n          <SelectValue>\n            {selectedChainData && (\n              <div\n                className={cn(\"flex items-center gap-x-2 w-full\", className)}\n              >\n                <img\n                  src={selectedChainData?.logo}\n                  alt={selectedChainData?.name}\n                  width={24}\n                  height={24}\n                  className=\"rounded-full\"\n                />\n                <p className=\"text-primary test-sm\">\n                  {selectedChainData?.name}\n                </p>\n              </div>\n            )}\n          </SelectValue>\n        </SelectTrigger>\n      </div>\n\n      <SelectContent>\n        <SelectGroup className=\"grid grid-cols-2 gap-2 max-h-[400px] overflow-y-scroll no-scrollbar\">\n          {supportedChainsAndTokens?.map((chain) => {\n            return (\n              <SelectItem key={chain.id} value={String(chain.id)}>\n                <div className=\"flex items-center gap-x-2 my-1\">\n                  <img\n                    src={chain.logo}\n                    alt={chain?.name}\n                    width={24}\n                    height={24}\n                    className=\"rounded-full\"\n                  />\n                  <p className=\"text-primary test-sm\">{chain.name}</p>\n                </div>\n              </SelectItem>\n            );\n          })}\n        </SelectGroup>\n      </SelectContent>\n    </Select>\n  );\n};\n\nexport default ChainSelect;\n",
      "type": "registry:component",
      "target": "components/transfer/components/chain-select.tsx"
    },
    {
      "path": "registry/nexus-elements/transfer/components/fee-breakdown.tsx",
      "content": "import { type FC } from \"react\";\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"../../ui/accordion\";\nimport { type ReadableIntent } from \"@avail-project/nexus-core\";\nimport { Skeleton } from \"../../ui/skeleton\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\nimport { Tooltip, TooltipContent, TooltipTrigger } from \"../../ui/tooltip\";\nimport { MessageCircleQuestion } from \"lucide-react\";\n\ninterface FeeBreakdownProps {\n  intent: ReadableIntent;\n  isLoading?: boolean;\n}\n\nconst FeeBreakdown: FC<FeeBreakdownProps> = ({ intent, isLoading = false }) => {\n  const { nexusSDK } = useNexus();\n\n  const feeRows = [\n    {\n      key: \"caGas\",\n      label: \"Fast Transfer Gas Fees\",\n      value: intent?.fees?.caGas,\n      description:\n        \"Gas cost required to execute the transfer on the destination chain.\",\n    },\n    {\n      key: \"gasSupplied\",\n      label: \"Gas Supplied\",\n      value: intent?.fees?.gasSupplied,\n      description:\n        \"Extra gas tokens supplied to ensure the transfer completes on-chain.\",\n    },\n    {\n      key: \"solver\",\n      label: \"Solver Fees\",\n      value: intent?.fees?.solver,\n      description:\n        \"Paid to the solver that routes and confirms the transfer quickly.\",\n    },\n    {\n      key: \"protocol\",\n      label: \"Protocol Fees\",\n      value: intent?.fees?.protocol,\n      description:\n        \"Nexus protocol fee that funds bridge maintenance and operations.\",\n    },\n  ];\n  return (\n    <Accordion type=\"single\" collapsible className=\"w-full\">\n      <AccordionItem value=\"breakdown\">\n        <div className=\"w-full flex items-start justify-between\">\n          <p className=\"font-light text-base\">Total fees</p>\n\n          <div className=\"flex flex-col items-end justify-end-safe gap-y-1\">\n            {isLoading ? (\n              <Skeleton className=\"h-5 w-24\" />\n            ) : (\n              <p className=\"font-light text-base min-w-max\">\n                {nexusSDK?.utils?.formatTokenBalance(intent.fees?.total, {\n                  symbol: intent.token?.symbol,\n                  decimals: intent?.token?.decimals,\n                })}\n              </p>\n            )}\n            <AccordionTrigger\n              containerClassName=\"w-fit\"\n              className=\"p-0 items-center gap-x-1\"\n              hideChevron={false}\n            >\n              <p className=\"text-sm font-light\">View Breakup</p>\n            </AccordionTrigger>\n          </div>\n        </div>\n        <AccordionContent>\n          <div className=\"w-full flex flex-col items-center justify-between gap-y-3 bg-muted px-4 py-2 rounded-lg mt-2\">\n            {feeRows.map(({ key, label, value, description }) => {\n              if (Number.parseFloat(value ?? \"0\") <= 0) return null;\n              return (\n                <Tooltip key={key}>\n                  <div className=\"flex items-center w-full justify-between\">\n                    <div className=\"flex items-center gap-x-2\">\n                      <p className=\"text-sm font-light\">{label}</p>\n                      <TooltipTrigger asChild>\n                        <MessageCircleQuestion className=\"size-4\" />\n                      </TooltipTrigger>\n                    </div>\n                    {isLoading ? (\n                      <Skeleton className=\"h-4 w-20\" />\n                    ) : (\n                      <p className=\"text-sm font-light\">\n                        {nexusSDK?.utils?.formatTokenBalance(value, {\n                          symbol: intent.token?.symbol,\n                          decimals: intent?.token?.decimals,\n                        })}\n                      </p>\n                    )}\n                  </div>\n                  <TooltipContent\n                    sideOffset={20}\n                    className=\"max-w-sm text-balance\"\n                  >\n                    <p className=\"text-sm font-light\">{description}</p>\n                  </TooltipContent>\n                </Tooltip>\n              );\n            })}\n          </div>\n        </AccordionContent>\n      </AccordionItem>\n    </Accordion>\n  );\n};\n\nexport default FeeBreakdown;\n",
      "type": "registry:component",
      "target": "components/transfer/components/fee-breakdown.tsx"
    },
    {
      "path": "registry/nexus-elements/transfer/components/recipient-address.tsx",
      "content": "\"use client\";\nimport { type FC, useState } from \"react\";\nimport { Input } from \"../../ui/input\";\nimport { Check, Edit } from \"lucide-react\";\nimport { Button } from \"../../ui/button\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\nimport { type Address } from \"viem\";\n\ninterface RecipientAddressProps {\n  address?: Address;\n  onChange: (address: string) => void;\n  disabled?: boolean;\n}\n\nconst RecipientAddress: FC<RecipientAddressProps> = ({\n  address,\n  onChange,\n  disabled,\n}) => {\n  const { nexusSDK } = useNexus();\n  const [isEditing, setIsEditing] = useState(false);\n  return (\n    <div className=\"w-full\">\n      {isEditing ? (\n        <div className=\"flex items-center w-full justify-between gap-x-4\">\n          <Input\n            value={address}\n            placeholder=\"Enter Recipient Address\"\n            onChange={(e) => onChange(e.target.value)}\n            className=\"w-full\"\n            disabled={disabled}\n          />\n          <Button\n            variant={\"ghost\"}\n            size={\"icon\"}\n            onClick={() => {\n              setIsEditing(false);\n            }}\n            disabled={disabled}\n          >\n            <Check className=\"size-5\" />\n          </Button>\n        </div>\n      ) : (\n        <div className=\"flex flex-col sm:flex-row items-start sm:items-center w-full justify-between\">\n          <p className=\"font-light text-base\">Recipient Address</p>\n          <div className=\"flex items-center gap-x-3 \">\n            {address && (\n              <p className=\"font-light text-base\">\n                {nexusSDK?.utils?.truncateAddress(address, 6, 6)}\n              </p>\n            )}\n\n            <Button\n              variant={\"ghost\"}\n              size={\"icon\"}\n              onClick={() => {\n                setIsEditing(true);\n              }}\n              className=\"px-0 size-5\"\n              disabled={disabled}\n            >\n              <Edit className=\"size-5\" />\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default RecipientAddress;\n",
      "type": "registry:component",
      "target": "components/transfer/components/recipient-address.tsx"
    },
    {
      "path": "registry/nexus-elements/transfer/components/token-select.tsx",
      "content": "import {\n  type SUPPORTED_CHAINS_IDS,\n  type SUPPORTED_TOKENS,\n} from \"@avail-project/nexus-core\";\nimport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"../../ui/select\";\nimport { Label } from \"../../ui/label\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\nimport { useMemo } from \"react\";\n\ninterface TokenSelectProps {\n  selectedToken?: SUPPORTED_TOKENS;\n  selectedChain: SUPPORTED_CHAINS_IDS;\n  handleTokenSelect: (token: SUPPORTED_TOKENS) => void;\n  isTestnet?: boolean;\n  disabled?: boolean;\n  label?: string;\n}\n\nconst TokenSelect = ({\n  selectedToken,\n  selectedChain,\n  handleTokenSelect,\n  isTestnet = false,\n  disabled = false,\n  label,\n}: TokenSelectProps) => {\n  const { supportedChainsAndTokens } = useNexus();\n  const tokenData = useMemo(() => {\n    return supportedChainsAndTokens\n      ?.filter((chain) => chain.id === selectedChain)\n      .flatMap((chain) => chain.tokens);\n  }, [selectedChain, supportedChainsAndTokens]);\n\n  const selectedTokenData = tokenData?.find((token) => {\n    return token.symbol === selectedToken;\n  });\n\n  return (\n    <Select\n      value={selectedToken}\n      onValueChange={(value) =>\n        !disabled && handleTokenSelect(value as SUPPORTED_TOKENS)\n      }\n    >\n      <div className=\"flex flex-col items-start gap-y-1\">\n        {label && <Label className=\"text-sm font-semibold\">{label}</Label>}\n        <SelectTrigger\n          disabled={disabled}\n          className=\"w-full h-12! text-base font-light\"\n        >\n          <SelectValue placeholder=\"Select a token\" className=\"w-full\">\n            {selectedChain && selectedTokenData && (\n              <div className=\"flex items-center gap-x-2 w-full\">\n                <img\n                  src={selectedTokenData?.logo}\n                  alt={selectedTokenData?.symbol}\n                  width={24}\n                  height={24}\n                  className=\"rounded-full\"\n                />\n                {selectedToken}\n              </div>\n            )}\n          </SelectValue>\n        </SelectTrigger>\n      </div>\n\n      <SelectContent>\n        <SelectGroup>\n          {tokenData?.map((token) => (\n            <SelectItem key={token.symbol} value={token.symbol}>\n              <div className=\"flex items-center gap-x-2 my-1\">\n                <img\n                  src={token.logo}\n                  alt={token.symbol}\n                  width={24}\n                  height={24}\n                  className=\"rounded-full\"\n                />\n                <div className=\"flex flex-col\">\n                  <span>\n                    {isTestnet ? `${token.symbol} (Testnet)` : token.symbol}\n                  </span>\n                </div>\n              </div>\n            </SelectItem>\n          ))}\n        </SelectGroup>\n      </SelectContent>\n    </Select>\n  );\n};\n\nexport default TokenSelect;\n",
      "type": "registry:component",
      "target": "components/transfer/components/token-select.tsx"
    },
    {
      "path": "registry/nexus-elements/transfer/components/transaction-progress.tsx",
      "content": "import { Check, Circle, LoaderPinwheel } from \"lucide-react\";\nimport { type FC, memo, useMemo } from \"react\";\nimport {\n  type BridgeStepType,\n  type SwapStepType,\n} from \"@avail-project/nexus-core\";\n\ntype ProgressStep = BridgeStepType | SwapStepType;\n\ninterface TransactionProgressProps {\n  timer: number;\n  steps: Array<{ id: number; completed: boolean; step: ProgressStep }>;\n  viewIntentUrl?: string;\n  operationType?: string;\n  completed?: boolean;\n}\n\nexport const getOperationText = (type: string) => {\n  switch (type) {\n    case \"transfer\":\n      return \"Transferring\";\n    case \"swap\":\n      return \"Swapping\";\n    default:\n      return \"Processing\";\n  }\n};\n\ntype DisplayStep = { id: string; label: string; completed: boolean };\n\nconst StepList: FC<{ steps: DisplayStep[]; currentIndex: number }> = memo(\n  ({ steps, currentIndex }) => {\n    return (\n      <div className=\"w-full mt-6 space-y-6\">\n        {steps.map((s, idx) => {\n          const isCompleted = !!s.completed;\n          const isCurrent = currentIndex === -1 ? false : idx === currentIndex;\n\n          let rightIcon = <Circle className=\"size-5 text-muted-foreground\" />;\n          if (isCompleted) {\n            rightIcon = <Check className=\"size-5 text-green-600\" />;\n          } else if (isCurrent) {\n            rightIcon = (\n              <LoaderPinwheel className=\"size-5 animate-spin text-muted-foreground\" />\n            );\n          }\n\n          return (\n            <div\n              key={s.id}\n              className=\"flex items-center justify-between w-full\"\n            >\n              <div className=\"flex items-center gap-x-3\">\n                <span className=\"text-base font-semibold\">{s.label}</span>\n              </div>\n              {rightIcon}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n);\n\nconst TransactionProgress: FC<TransactionProgressProps> = ({\n  timer,\n  steps,\n  viewIntentUrl,\n  operationType = \"transfer\",\n  completed = false,\n}) => {\n  const totalSteps = Array.isArray(steps) ? steps.length : 0;\n  const completedSteps = Array.isArray(steps)\n    ? steps.reduce((acc, s) => acc + (s?.completed ? 1 : 0), 0)\n    : 0;\n  const rawPercent = totalSteps > 0 ? completedSteps / totalSteps : 0;\n  const percent = completed ? 1 : rawPercent;\n  const allCompleted = completed || percent >= 1;\n  const opText = getOperationText(operationType);\n  const headerText = allCompleted\n    ? `${opText} Completed`\n    : `${opText} In Progress...`;\n  const ctaText = allCompleted ? `View Explorer` : \"View Intent\";\n\n  const { effectiveSteps, currentIndex } = useMemo(() => {\n    const milestones = [\n      \"Intent verified\",\n      \"Collected on sources\",\n      \"Filled on destination\",\n    ];\n    const thresholds = milestones.map(\n      (_, idx) => (idx + 1) / milestones.length\n    );\n    const displaySteps: DisplayStep[] = milestones.map((label, idx) => ({\n      id: `M${idx}`,\n      label,\n      completed: percent >= thresholds[idx],\n    }));\n    const current = displaySteps.findIndex((st) => !st.completed);\n    return { effectiveSteps: displaySteps, currentIndex: current };\n  }, [percent, opText, completed]);\n\n  return (\n    <div className=\"w-full flex flex-col items-center\">\n      <div className=\"flex flex-col items-center gap-y-3\">\n        {allCompleted ? (\n          <Check className=\"size-6 text-green-600\" />\n        ) : (\n          <LoaderPinwheel className=\"size-6 animate-spin\" />\n        )}\n        <p>{headerText}</p>\n        <div className=\"flex items-center justify-center w-full\">\n          <span className=\"text-2xl font-semibold font-nexus-primary text-nexus-black\">\n            {Math.floor(timer)}\n          </span>\n          <span className=\"text-base font-semibold font-nexus-primary text-nexus-black\">\n            .\n          </span>\n          <span className=\"text-base font-semibold font-nexus-primary text-nexus-muted-secondary\">\n            {String(Math.floor((timer % 1) * 1000)).padStart(3, \"0\")}s\n          </span>\n        </div>\n      </div>\n\n      <StepList steps={effectiveSteps} currentIndex={currentIndex} />\n\n      {viewIntentUrl && (\n        <a\n          href={viewIntentUrl}\n          target=\"_blank\"\n          rel=\"noreferrer\"\n          className=\"mt-8 underline font-semibold\"\n        >\n          {ctaText}\n        </a>\n      )}\n    </div>\n  );\n};\n\nexport default TransactionProgress;\n",
      "type": "registry:component",
      "target": "components/transfer/components/transaction-progress.tsx"
    },
    {
      "path": "registry/nexus-elements/transfer/hooks/useTransfer.ts",
      "content": "import {\n  type BridgeStepType,\n  NEXUS_EVENTS,\n  type NexusNetwork,\n  NexusSDK,\n  type OnAllowanceHookData,\n  type OnIntentHookData,\n  SUPPORTED_CHAINS,\n  type SUPPORTED_CHAINS_IDS,\n  type SUPPORTED_TOKENS,\n  type UserAsset,\n} from \"@avail-project/nexus-core\";\nimport {\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  useReducer,\n  type RefObject,\n} from \"react\";\nimport { type Address, isAddress } from \"viem\";\nimport {\n  useStopwatch,\n  usePolling,\n  useTransactionSteps,\n  type TransactionStatus,\n  useNexusError,\n} from \"../../common\";\n\nexport interface FastTransferState {\n  chain: SUPPORTED_CHAINS_IDS;\n  token: SUPPORTED_TOKENS;\n  amount?: string;\n  recipient: `0x${string}`;\n}\n\ninterface UseTransferProps {\n  network: NexusNetwork;\n  nexusSDK: NexusSDK | null;\n  intent: RefObject<OnIntentHookData | null>;\n  allowance: RefObject<OnAllowanceHookData | null>;\n  bridgableBalance: UserAsset[] | null;\n  prefill?: {\n    token: string;\n    chainId: number;\n    amount?: string;\n    recipient?: Address;\n  };\n  onComplete?: () => void;\n  onStart?: () => void;\n  onError?: (message: string) => void;\n  fetchBalance: () => Promise<void>;\n}\n\ninterface TransferState {\n  inputs: FastTransferState;\n  status: TransactionStatus;\n}\ntype Action =\n  | { type: \"setInputs\"; payload: Partial<FastTransferState> }\n  | { type: \"resetInputs\" }\n  | { type: \"setStatus\"; payload: TransactionStatus };\n\nconst buildInitialInputs = (\n  network: NexusNetwork,\n  prefill?: {\n    token: string;\n    chainId: number;\n    amount?: string;\n    recipient?: Address;\n  }\n): FastTransferState => {\n  return {\n    chain:\n      (prefill?.chainId as SUPPORTED_CHAINS_IDS) ??\n      (network === \"testnet\"\n        ? SUPPORTED_CHAINS.SEPOLIA\n        : SUPPORTED_CHAINS.ETHEREUM),\n    token: (prefill?.token as SUPPORTED_TOKENS) ?? \"USDC\",\n    amount: prefill?.amount ?? undefined,\n    recipient: (prefill?.recipient as `0x${string}`) ?? undefined,\n  };\n};\n\nconst useTransfer = ({\n  network,\n  nexusSDK,\n  intent,\n  bridgableBalance,\n  prefill,\n  onComplete,\n  onStart,\n  onError,\n  allowance,\n  fetchBalance,\n}: UseTransferProps) => {\n  const handleNexusError = useNexusError();\n  const initialState: TransferState = {\n    inputs: buildInitialInputs(network, prefill),\n    status: \"idle\",\n  };\n  function reducer(state: TransferState, action: Action): TransferState {\n    switch (action.type) {\n      case \"setInputs\":\n        return { ...state, inputs: { ...state.inputs, ...action.payload } };\n      case \"resetInputs\":\n        return {\n          ...state,\n          inputs: buildInitialInputs(network, prefill),\n        };\n      case \"setStatus\":\n        return { ...state, status: action.payload };\n      default:\n        return state;\n    }\n  }\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const inputs = state.inputs;\n  const setInputs = (next: FastTransferState | Partial<FastTransferState>) => {\n    dispatch({\n      type: \"setInputs\",\n      payload: next as Partial<FastTransferState>,\n    });\n  };\n\n  const loading = state.status === \"executing\";\n  const [refreshing, setRefreshing] = useState(false);\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [txError, setTxError] = useState<string | null>(null);\n  const [lastExplorerUrl, setLastExplorerUrl] = useState<string>(\"\");\n  const commitLockRef = useRef<boolean>(false);\n  const {\n    steps,\n    onStepsList,\n    onStepComplete,\n    reset: resetSteps,\n  } = useTransactionSteps<BridgeStepType>();\n\n  const areInputsValid = useMemo(() => {\n    const hasToken = inputs?.token !== undefined && inputs?.token !== null;\n    const hasChain = inputs?.chain !== undefined && inputs?.chain !== null;\n    const hasAmount = Boolean(inputs?.amount) && Number(inputs?.amount) > 0;\n    const hasValidrecipient =\n      Boolean(inputs?.recipient) && isAddress(inputs?.recipient as string);\n    return hasToken && hasChain && hasAmount && hasValidrecipient;\n  }, [inputs]);\n\n  const handleTransaction = async () => {\n    if (\n      !inputs?.amount ||\n      !inputs?.recipient ||\n      !inputs?.chain ||\n      !inputs?.token\n    ) {\n      console.error(\"Missing required inputs\");\n      return;\n    }\n    dispatch({ type: \"setStatus\", payload: \"executing\" });\n    setTxError(null);\n    onStart?.();\n    try {\n      if (!nexusSDK) {\n        throw new Error(\"Nexus SDK not initialized\");\n      }\n      const amountBigInt = nexusSDK.convertTokenReadableAmountToBigInt(\n        inputs?.amount,\n        inputs?.token,\n        inputs?.chain\n      );\n      const transferTxn = await nexusSDK.bridgeAndTransfer(\n        {\n          token: inputs?.token,\n          amount: amountBigInt,\n          toChainId: inputs?.chain,\n          recipient: inputs?.recipient,\n        },\n        {\n          onEvent: (event) => {\n            if (event.name === NEXUS_EVENTS.STEPS_LIST) {\n              const list = Array.isArray(event.args) ? event.args : [];\n              onStepsList(list);\n            }\n            if (event.name === NEXUS_EVENTS.STEP_COMPLETE) {\n              onStepComplete(event.args);\n            }\n          },\n        }\n      );\n      if (!transferTxn) {\n        throw new Error(\"Transaction rejected by user\");\n      }\n      if (transferTxn) {\n        setLastExplorerUrl(transferTxn.explorerUrl);\n        await onSuccess();\n      }\n    } catch (error) {\n      const { message } = handleNexusError(error);\n      intent.current?.deny();\n      intent.current = null;\n      allowance.current = null;\n      setTxError(message);\n      onError?.(message);\n      setIsDialogOpen(false);\n      dispatch({ type: \"setStatus\", payload: \"error\" });\n    }\n  };\n\n  const onSuccess = async () => {\n    // Close dialog and stop timer on success\n    stopwatch.stop();\n    dispatch({ type: \"setStatus\", payload: \"success\" });\n    onComplete?.();\n    intent.current = null;\n    allowance.current = null;\n    dispatch({ type: \"resetInputs\" });\n    setRefreshing(false);\n    await fetchBalance();\n  };\n\n  const filteredBridgableBalance = useMemo(() => {\n    return bridgableBalance?.find((bal) => bal?.symbol === inputs?.token);\n  }, [bridgableBalance, inputs?.token]);\n\n  const refreshIntent = async () => {\n    setRefreshing(true);\n    try {\n      await intent.current?.refresh([]);\n    } catch (error) {\n      console.error(\"Transaction failed:\", error);\n    } finally {\n      setRefreshing(false);\n    }\n  };\n\n  const reset = () => {\n    intent.current?.deny();\n    intent.current = null;\n    allowance.current = null;\n    dispatch({ type: \"resetInputs\" });\n    dispatch({ type: \"setStatus\", payload: \"idle\" });\n    setRefreshing(false);\n    stopwatch.stop();\n    stopwatch.reset();\n    resetSteps();\n  };\n\n  const startTransaction = () => {\n    // Reset timer for a fresh run\n    intent.current?.allow();\n    setIsDialogOpen(true);\n    setTxError(null);\n  };\n\n  const commitAmount = async () => {\n    if (commitLockRef.current) return;\n    if (intent.current || loading || txError || !areInputsValid) return;\n    commitLockRef.current = true;\n    try {\n      await handleTransaction();\n    } finally {\n      commitLockRef.current = false;\n    }\n  };\n\n  usePolling(Boolean(intent.current) && !isDialogOpen, refreshIntent, 15000);\n\n  const stopwatch = useStopwatch({ running: isDialogOpen, intervalMs: 100 });\n\n  useEffect(() => {\n    if (intent.current) {\n      intent.current.deny();\n      intent.current = null;\n    }\n  }, [inputs]);\n\n  useEffect(() => {\n    if (!isDialogOpen) {\n      stopwatch.stop();\n      stopwatch.reset();\n    }\n  }, [isDialogOpen, stopwatch]);\n\n  useEffect(() => {\n    if (txError) {\n      setTxError(null);\n    }\n  }, [inputs]);\n\n  return {\n    inputs,\n    setInputs,\n    timer: stopwatch.seconds,\n    setIsDialogOpen,\n    setTxError,\n    loading,\n    refreshing,\n    isDialogOpen,\n    txError,\n    handleTransaction,\n    reset,\n    filteredBridgableBalance,\n    startTransaction,\n    commitAmount,\n    lastExplorerUrl,\n    steps,\n    status: state.status,\n  };\n};\n\nexport default useTransfer;\n",
      "type": "registry:component",
      "target": "components/transfer/hooks/useTransfer.ts"
    }
  ]
}