{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "deposit",
  "type": "registry:component",
  "title": "Deposit",
  "description": "A simple component built with Nexus to enable deposits",
  "dependencies": [
    "lucide-react",
    "@radix-ui/react-tabs",
    "@radix-ui/react-dialog",
    "@radix-ui/react-accordion",
    "@radix-ui/react-label",
    "@radix-ui/react-popover",
    "@radix-ui/react-checkbox",
    "@radix-ui/react-slot"
  ],
  "registryDependencies": [
    "https://elements.nexus.availproject.org/r/accordion.json",
    "https://elements.nexus.availproject.org/r/button.json",
    "https://elements.nexus.availproject.org/r/card.json",
    "https://elements.nexus.availproject.org/r/dialog.json",
    "https://elements.nexus.availproject.org/r/input.json",
    "https://elements.nexus.availproject.org/r/label.json",
    "https://elements.nexus.availproject.org/r/nexus-provider.json",
    "https://elements.nexus.availproject.org/r/utils.json",
    "https://elements.nexus.availproject.org/r/tabs.json"
  ],
  "files": [
    {
      "path": "registry/nexus-elements/deposit/deposit.tsx",
      "content": "import {\n  SUPPORTED_CHAINS_IDS,\n  type SUPPORTED_TOKENS,\n} from \"@avail-project/nexus-core\";\nimport React from \"react\";\nimport DepositModal from \"./components/deposit-modal\";\nimport { Abi, Address } from \"viem\";\nimport Container from \"./components/container\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"../ui/card\";\nimport { useNexus } from \"../nexus/NexusProvider\";\n\nexport interface BaseDepositProps {\n  address: Address;\n  token?: SUPPORTED_TOKENS;\n  chain: SUPPORTED_CHAINS_IDS;\n  chainOptions?: {\n    id: number;\n    name: string;\n    logo: string;\n  }[];\n  depositExecute?: {\n    contractAddress: string;\n    contractAbi: Abi;\n    functionName: string;\n    buildFunctionParams: (\n      token: SUPPORTED_TOKENS,\n      amount: string,\n      chainId: SUPPORTED_CHAINS_IDS,\n      userAddress: `0x${string}`\n    ) => { functionParams: unknown[] };\n    tokenApproval?: {\n      token: SUPPORTED_TOKENS;\n      amount: string;\n    };\n  };\n}\n\ninterface NexusDepositProps extends BaseDepositProps {\n  heading?: string;\n  embed?: boolean;\n  destinationLabel?: string;\n}\n\nconst NexusDeposit = ({\n  address,\n  token = \"USDC\",\n  chain,\n  chainOptions,\n  heading = \"Deposit USDC\",\n  embed = false,\n  destinationLabel,\n  depositExecute,\n}: NexusDepositProps) => {\n  const { supportedChainsAndTokens } = useNexus();\n  const formatedChainOptions =\n    chainOptions ??\n    supportedChainsAndTokens?.map((chain) => {\n      return {\n        id: chain.id,\n        name: chain.name,\n        logo: chain.logo,\n      };\n    });\n  if (embed) {\n    return (\n      <Card>\n        <CardHeader className=\"px-3\">\n          <CardTitle>{heading}</CardTitle>\n        </CardHeader>\n        <CardContent className=\"px-3\">\n          <Container\n            address={address}\n            token={token}\n            chain={chain}\n            chainOptions={formatedChainOptions}\n            destinationLabel={destinationLabel}\n            depositExecute={depositExecute}\n          />\n        </CardContent>\n      </Card>\n    );\n  }\n  return (\n    <DepositModal\n      address={address}\n      token={token}\n      chain={chain}\n      chainOptions={formatedChainOptions}\n      heading={heading}\n      destinationLabel={destinationLabel}\n      depositExecute={depositExecute}\n    />\n  );\n};\n\nexport default NexusDeposit;\n",
      "type": "registry:component",
      "target": "components/deposit/deposit.tsx"
    },
    {
      "path": "registry/nexus-elements/deposit/components/container.tsx",
      "content": "\"use client\";\n\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"../../ui/tabs\";\nimport SimpleDeposit from \"./simple-deposit\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\nimport { BaseDepositProps } from \"../deposit\";\n\ninterface ContainerProps extends BaseDepositProps {\n  fiatSubheading?: string;\n  destinationLabel?: string;\n}\n\nconst Container = ({\n  address,\n  fiatSubheading = \"Cards, Apple Pay\",\n  token,\n  chain,\n  chainOptions,\n  destinationLabel,\n  depositExecute,\n}: ContainerProps) => {\n  const { nexusSDK } = useNexus();\n  return (\n    <Tabs defaultValue=\"simple\" className=\"w-full min-w-sm\">\n      <TabsList className=\"h-12 p-0 w-full\">\n        <TabsTrigger value=\"simple\" className=\"px-2 py-1\">\n          <div className=\"flex items-center flex-col gap-y-1\">\n            <p className=\"text-sm data-[state=active]:font-bold\">Wallet</p>\n            <p className=\"text-[10px]\">\n              {nexusSDK?.utils?.truncateAddress(address, 4, 4)}\n            </p>\n          </div>\n        </TabsTrigger>\n        <TabsTrigger value=\"qr\" className=\"px-2 py-1\">\n          <div className=\"flex items-center flex-col gap-y-1\">\n            <p className=\"text-sm data-[state=active]:font-bold\">Transfer QR</p>\n            <p className=\"text-[10px]\">{chainOptions?.length ?? \"0\"} chains</p>\n          </div>\n        </TabsTrigger>\n        <TabsTrigger value=\"fiat\" className=\"px-2 py-1\">\n          <div className=\"flex items-center flex-col gap-y-1\">\n            <p className=\"text-sm data-[state=active]:font-bold\">Fiat</p>\n            <p className=\"text-[10px]\">{fiatSubheading}</p>\n          </div>\n        </TabsTrigger>\n      </TabsList>\n      <TabsContent value=\"simple\">\n        <SimpleDeposit\n          token={token}\n          chain={chain}\n          chainOptions={chainOptions}\n          destinationLabel={destinationLabel}\n          depositExecute={depositExecute}\n        />\n      </TabsContent>\n      <TabsContent value=\"qr\">\n        <p className=\"text-xl text-primary text-center\">Coming soon</p>\n      </TabsContent>\n      <TabsContent value=\"fiat\">\n        <p className=\"text-xl text-primary text-center\">Coming soon</p>\n      </TabsContent>\n    </Tabs>\n  );\n};\n\nexport default Container;\n",
      "type": "registry:component",
      "target": "components/deposit/components/container.tsx"
    },
    {
      "path": "registry/nexus-elements/deposit/components/deposit-modal.tsx",
      "content": "\"use client\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"../../ui/dialog\";\nimport Container from \"./container\";\nimport { BaseDepositProps } from \"../deposit\";\nimport { Button } from \"../../ui/button\";\n\ninterface DepositModalProps extends BaseDepositProps {\n  heading?: string;\n  destinationLabel?: string;\n}\n\nconst DepositModal = ({\n  address,\n  token,\n  chain,\n  chainOptions,\n  heading,\n  destinationLabel,\n  depositExecute,\n}: DepositModalProps) => {\n  return (\n    <Dialog>\n      <DialogTrigger asChild>\n        <Button>Deposit</Button>\n      </DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{heading}</DialogTitle>\n        </DialogHeader>\n        <Container\n          address={address}\n          token={token}\n          chain={chain}\n          chainOptions={chainOptions}\n          destinationLabel={destinationLabel}\n          depositExecute={depositExecute}\n        />\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default DepositModal;\n",
      "type": "registry:component",
      "target": "components/deposit/components/deposit-modal.tsx"
    },
    {
      "path": "registry/nexus-elements/deposit/components/simple-deposit.tsx",
      "content": "\"use client\";\n\nimport { BaseDepositProps } from \"../deposit\";\nimport AmountInput from \"./amount-input\";\nimport SourceSelect from \"./source-select\";\nimport { Button } from \"../../ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"../../ui/dialog\";\nimport AllowanceModal from \"../../fast-bridge/components/allowance-modal\";\nimport BridgeExecuteProgress from \"./transaction-progress\";\nimport DepositFeeBreakdown from \"./fee-breakdown\";\nimport SourceBreakdown from \"../../fast-bridge/components/source-breakdown\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\nimport useListenTransaction from \"../../fast-bridge/hooks/useListenTransaction\";\nimport React from \"react\";\nimport useDeposit from \"../hooks/useDeposit\";\nimport { LoaderPinwheel, X } from \"lucide-react\";\n\ninterface SimpleDepositProps extends Omit<BaseDepositProps, \"address\"> {\n  destinationLabel?: string;\n}\n\nconst SimpleDeposit = ({\n  token,\n  chain,\n  chainOptions,\n  destinationLabel = \"on Hyperliquid Perps\",\n  depositExecute,\n}: SimpleDepositProps) => {\n  const {\n    nexusSDK,\n    intent,\n    setIntent,\n    unifiedBalance,\n    allowance,\n    setAllowance,\n  } = useNexus();\n\n  const {\n    inputs,\n    setInputs,\n    loading,\n    simulating,\n    lastResult,\n    isDialogOpen,\n    setIsDialogOpen,\n    txError,\n    setTxError,\n    timer,\n    filteredUnifiedBalance,\n    simulation,\n    startTransaction,\n    stopTimer,\n    clearSimulation,\n    simulate,\n  } = useDeposit({\n    chain,\n    nexusSDK,\n    intent,\n    setIntent,\n    unifiedBalance,\n    allowance,\n    setAllowance,\n    chainOptions,\n    executeConfig: depositExecute,\n  });\n\n  const { processing, explorerUrl } = useListenTransaction(\n    nexusSDK,\n    \"bridgeAndExecute\"\n  );\n  const allCompleted =\n    processing?.length > 0 && processing.every((s) => s.completed);\n  React.useEffect(() => {\n    if (allCompleted) stopTimer();\n  }, [allCompleted, stopTimer]);\n\n  return (\n    <div className=\"flex flex-col items-center w-full gap-y-3 rounded-lg\">\n      <SourceSelect\n        chainOptions={chainOptions}\n        selected={inputs?.selectedSources}\n        onChange={(selected) =>\n          setInputs({ ...inputs, selectedSources: selected })\n        }\n        disabled={Boolean(simulation?.success && !simulation?.bridgeSimulation)}\n      />\n      <AmountInput\n        token={token}\n        value={inputs?.amount}\n        onChange={(value) => setInputs({ ...inputs, amount: value })}\n        unifiedBalance={filteredUnifiedBalance}\n        disabled={loading || simulating}\n        onCommit={(value) => {\n          setInputs({ ...inputs, amount: value });\n          void simulate(value);\n        }}\n      />\n\n      {simulation?.success && simulation?.bridgeSimulation?.intent && (\n        <>\n          <SourceBreakdown\n            intent={simulation?.bridgeSimulation?.intent as any}\n            tokenSymbol={filteredUnifiedBalance?.symbol as \"USDC\"}\n          />\n          <div className=\"w-full flex items-start justify-between gap-x-4\">\n            <p className=\"text-base font-semibold\">You receive</p>\n            <div className=\"flex flex-col gap-y-1 min-w-fit\">\n              <p className=\"text-base font-semibold text-right\">\n                {inputs?.amount} {filteredUnifiedBalance?.symbol}\n              </p>\n              <p className=\"text-sm font-medium text-right\">\n                {destinationLabel}\n              </p>\n            </div>\n          </div>\n          <DepositFeeBreakdown\n            total={simulation?.totalEstimatedCost?.total ?? \"0\"}\n            bridge={simulation?.totalEstimatedCost?.breakdown?.bridge ?? \"0\"}\n            execute={simulation?.totalEstimatedCost?.breakdown?.execute ?? \"0\"}\n            tokenSymbol={filteredUnifiedBalance?.symbol as \"USDC\"}\n          />\n        </>\n      )}\n\n      {simulation?.success && !simulation?.bridgeSimulation && (\n        <>\n          <div className=\"w-full flex items-start justify-between gap-x-4\">\n            <p className=\"text-base font-semibold\">You receive</p>\n            <div className=\"flex flex-col gap-y-1 min-w-fit\">\n              <p className=\"text-base font-semibold text-right\">\n                {simulation?.metadata?.bridgeReceiveAmount ?? inputs?.amount}{\" \"}\n                {filteredUnifiedBalance?.symbol}\n              </p>\n              <p className=\"text-sm font-medium text-right\">\n                {destinationLabel}\n              </p>\n            </div>\n          </div>\n          <DepositFeeBreakdown\n            total={simulation?.totalEstimatedCost?.total ?? \"0\"}\n            bridge={simulation?.totalEstimatedCost?.breakdown?.bridge ?? \"0\"}\n            execute={simulation?.totalEstimatedCost?.breakdown?.execute ?? \"0\"}\n            tokenSymbol={filteredUnifiedBalance?.symbol as \"USDC\"}\n          />\n          <div className=\"w-full text-sm text-muted-foreground px-2\">\n            Bridge skipped, executing directly on destination chain\n          </div>\n        </>\n      )}\n\n      {!intent &&\n        (simulation?.success ? (\n          <div className=\"w-full flex items-center gap-x-2\">\n            <Button\n              variant={\"destructive\"}\n              onClick={() => {\n                clearSimulation();\n                setTxError(null);\n              }}\n              className=\"w-1/2\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={startTransaction}\n              disabled={loading || simulating}\n              className=\"w-1/2\"\n            >\n              {loading ? (\n                <div className=\"flex items-center gap-x-2\">\n                  <LoaderPinwheel className=\"animate-spin size-4\" />\n                  <p>Preparing quote</p>\n                </div>\n              ) : (\n                \"Deposit\"\n              )}\n            </Button>\n          </div>\n        ) : (\n          <Button disabled={true} className=\"w-full\">\n            {loading || simulating ? (\n              <div className=\"flex items-center gap-x-2\">\n                <LoaderPinwheel className=\"animate-spin size-4\" />\n                <p>Preparing quote</p>\n              </div>\n            ) : (\n              \"Deposit\"\n            )}\n          </Button>\n        ))}\n\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent>\n          <DialogHeader className=\"sr-only\">\n            <DialogTitle>Transaction Progress</DialogTitle>\n          </DialogHeader>\n          <BridgeExecuteProgress\n            timer={timer}\n            steps={processing}\n            intentUrl={explorerUrl ?? simulation ?? undefined}\n            executeUrl={lastResult?.executeExplorerUrl}\n          />\n        </DialogContent>\n      </Dialog>\n\n      {allowance && (\n        <AllowanceModal\n          allowanceModal={allowance}\n          setAllowanceModal={setAllowance}\n          callback={startTransaction}\n        />\n      )}\n\n      {txError && (\n        <div className=\"rounded-md border border-destructive bg-destructive/80 px-3 py-2 text-sm text-destructive-foreground flex items-start justify-between gap-x-3 mt-3 w-full max-w-lg\">\n          <span className=\"flex-1 max-w-\">{txError}</span>\n          <Button\n            type=\"button\"\n            size={\"icon\"}\n            variant={\"ghost\"}\n            onClick={() => {\n              clearSimulation();\n              setTxError(null);\n            }}\n            className=\"text-destructive-foreground/80 hover:text-destructive-foreground focus:outline-none\"\n            aria-label=\"Dismiss error\"\n          >\n            <X className=\"size-4\" />\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SimpleDeposit;\n\n/**\n * add shimmer when simulating\n * when refreshing, say refreshing quote\n * keep txn processor copy deposit oriented\n * when txn has started make sure the deposit button (L169) doesn't say prepare quote, this is happening because of shared loading state variable\n * do custom copy for bridge and execute altogether\n */\n",
      "type": "registry:component",
      "target": "components/deposit/components/simple-deposit.tsx"
    },
    {
      "path": "registry/nexus-elements/deposit/components/source-select.tsx",
      "content": "import { ChevronDown } from \"lucide-react\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"../../ui/popover\";\nimport { Label } from \"../../ui/label\";\nimport { Checkbox } from \"../../ui/checkbox\";\n\ninterface SourceSelectProps {\n  chainOptions?: {\n    id: number;\n    name: string;\n    logo: string;\n  }[];\n  selected?: number[];\n  onChange?: (selected: number[]) => void;\n  disabled?: boolean;\n}\n\nconst SourceSelect = ({\n  chainOptions,\n  selected = [],\n  onChange,\n  disabled = false,\n}: SourceSelectProps) => {\n  const isSelected = (id: number) => selected?.includes(id);\n  const toggle = (id: number) => {\n    if (!onChange) return;\n    if (disabled) return;\n    if (isSelected(id)) onChange(selected.filter((s) => s !== id));\n    else onChange([...selected, id]);\n  };\n  return (\n    <Popover>\n      <PopoverTrigger\n        disabled={disabled}\n        aria-disabled={disabled}\n        className={`flex items-center justify-between w-full p-2 ${\n          disabled ? \"cursor-not-allowed opacity-60\" : \"cursor-pointer\"\n        }`}\n      >\n        Customise Source Assets (Use Any){\" \"}\n        <ChevronDown className=\"size-4 text-primary data-[state=open]:rotate-180 shrink-0 translate-y-0.5 transition-transform duration-200\" />\n      </PopoverTrigger>\n      <PopoverContent className=\"grid grid-cols-2 w-max\">\n        {chainOptions ? (\n          chainOptions?.map((chain) => {\n            return (\n              <div key={chain.id} className=\"flex items-center gap-x-2\">\n                <Checkbox\n                  checked={isSelected(chain.id)}\n                  onCheckedChange={() => toggle(chain.id)}\n                  value={chain.id}\n                  disabled={disabled}\n                  className={`${\n                    disabled ? \"cursor-not-allowed\" : \"cursor-pointer\"\n                  }`}\n                />\n                <div className=\"flex items-center gap-x-2 p-2\">\n                  <img\n                    src={chain.logo}\n                    alt={chain?.name}\n                    width={24}\n                    height={24}\n                    className=\"rounded-full\"\n                  />\n                  <Label\n                    className=\"text-primary test-sm\"\n                    htmlFor={String(chain.id)}\n                  >\n                    {chain.name}\n                  </Label>\n                </div>\n              </div>\n            );\n          })\n        ) : (\n          <p>No option available</p>\n        )}\n      </PopoverContent>\n    </Popover>\n  );\n};\nexport default SourceSelect;\n",
      "type": "registry:component",
      "target": "components/deposit/components/source-select.tsx"
    },
    {
      "path": "registry/nexus-elements/deposit/components/amount-input.tsx",
      "content": "\"use client\";\n\nimport {\n  type SUPPORTED_TOKENS,\n  type UserAsset,\n} from \"@avail-project/nexus-core\";\nimport { Button } from \"../../ui/button\";\nimport { Input } from \"../../ui/input\";\nimport { useCallback, useEffect, useRef } from \"react\";\n\nconst RANGE_OPTIONS = [\n  {\n    label: \"25%\",\n    value: 0.25,\n  },\n  {\n    label: \"50%\",\n    value: 0.5,\n  },\n  {\n    label: \"75%\",\n    value: 0.75,\n  },\n  {\n    label: \"MAX\",\n    value: 1.0,\n  },\n];\n\ninterface AmountInputProps {\n  token?: SUPPORTED_TOKENS;\n  value?: string;\n  onChange: (value: string) => void;\n  unifiedBalance?: UserAsset;\n  disabled?: boolean;\n  onCommit?: (value: string) => void;\n}\n\nconst AmountInput = ({\n  token,\n  value,\n  onChange,\n  unifiedBalance,\n  disabled,\n  onCommit,\n}: AmountInputProps) => {\n  const commitTimerRef = useRef<NodeJS.Timeout | null>(null);\n\n  const scheduleCommit = useCallback(\n    (val: string) => {\n      if (!onCommit || disabled) return;\n      if (commitTimerRef.current) clearTimeout(commitTimerRef.current);\n      commitTimerRef.current = setTimeout(() => {\n        onCommit(val);\n      }, 800);\n    },\n    [onCommit, disabled]\n  );\n\n  useEffect(() => {\n    return () => {\n      if (commitTimerRef.current) {\n        clearTimeout(commitTimerRef.current);\n        commitTimerRef.current = null;\n      }\n    };\n  }, []);\n\n  return (\n    <div className=\"flex flex-col items-start gap-y-1 w-full p-2\">\n      <div className=\"flex items-center justify-between w-full\">\n        <Input\n          type=\"number\"\n          inputMode=\"decimal\"\n          step=\"any\"\n          min=\"0\"\n          placeholder=\"1.002...\"\n          value={value ?? \"\"}\n          onChange={(e) => {\n            onChange(e.target.value);\n            scheduleCommit(e.target.value);\n          }}\n          onBlur={(e) => {\n            if (commitTimerRef.current) {\n              clearTimeout(commitTimerRef.current);\n              commitTimerRef.current = null;\n            }\n            onCommit?.(e.target.value);\n          }}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\") {\n              if (commitTimerRef.current) {\n                clearTimeout(commitTimerRef.current);\n                commitTimerRef.current = null;\n              }\n              onCommit?.(value ?? \"\");\n            }\n          }}\n          className=\"py-0 px-1  text-2xl! placeholder:text-2xl w-full border-none focus-visible:ring-0 focus-visible:ring-offset-0 shadow-none bg-transparent!\"\n          disabled={disabled}\n        />\n        <p>{token}</p>\n      </div>\n      <div className=\"flex gap-x-3\">\n        {RANGE_OPTIONS.map((option) => (\n          <Button\n            size={\"icon\"}\n            variant={\"ghost\"}\n            key={option.label}\n            className=\"text-xs py-0.5 px-0 size-max\"\n            disabled={disabled}\n            onClick={() => {\n              if (!unifiedBalance?.balance) return;\n              const max = Number(unifiedBalance?.balance);\n              const next = (max * option.value).toString();\n              onChange(next);\n              onCommit?.(next);\n            }}\n          >\n            {option.label}\n          </Button>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default AmountInput;\n",
      "type": "registry:component",
      "target": "components/deposit/components/amount-input.tsx"
    },
    {
      "path": "registry/nexus-elements/deposit/components/fee-breakdown.tsx",
      "content": "import React, { useCallback } from \"react\";\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"../../ui/accordion\";\nimport {\n  TOKEN_METADATA,\n  type SUPPORTED_TOKENS,\n} from \"@avail-project/nexus-core\";\n\ninterface DepositFeeBreakdownProps {\n  total: string;\n  bridge: string;\n  execute: string;\n  tokenSymbol: SUPPORTED_TOKENS;\n}\n\nconst DepositFeeBreakdown = ({\n  total,\n  bridge,\n  execute,\n  tokenSymbol,\n}: DepositFeeBreakdownProps) => {\n  const formatBalance = useCallback((balance: string, decimals: number) => {\n    const num = parseFloat(balance);\n    return num.toFixed(Math.min(6, decimals));\n  }, []);\n  return (\n    <Accordion type=\"single\" collapsible className=\"w-full\">\n      <AccordionItem value=\"deposit-fee-breakdown\">\n        <div className=\"w-full flex items-start justify-between\">\n          <p className=\"font-semibold text-base\">Total fees</p>\n\n          <div className=\"flex flex-col items-end justify-end-safe gap-y-1\">\n            <p className=\"font-semibold text-base min-w-max\">\n              {formatBalance(total, TOKEN_METADATA[tokenSymbol]?.decimals)}{\" \"}\n              {tokenSymbol}\n            </p>\n            <AccordionTrigger\n              containerClassName=\"w-fit\"\n              className=\"p-0 items-center gap-x-1\"\n              hideChevron={false}\n            >\n              <p className=\"text-sm font-medium\">View Breakdown</p>\n            </AccordionTrigger>\n          </div>\n        </div>\n        <AccordionContent>\n          <div className=\"w-full flex flex-col items-center justify-between gap-y-3 bg-muted px-4 py-2 rounded-lg mt-2\">\n            <div className=\"flex items-center w-full justify-between\">\n              <p className=\"text-sm font-semibold\">Transaction Fees</p>\n              <p className=\"text-sm font-semibold\">\n                {formatBalance(bridge, TOKEN_METADATA[tokenSymbol]?.decimals)}{\" \"}\n                {tokenSymbol}\n              </p>\n            </div>\n            <div className=\"flex items-center w-full justify-between\">\n              <p className=\"text-sm font-semibold\">Deposit Fee</p>\n              <p className=\"text-sm font-semibold\">\n                {formatBalance(execute, TOKEN_METADATA[tokenSymbol]?.decimals)}{\" \"}\n                {tokenSymbol}\n              </p>\n            </div>\n          </div>\n        </AccordionContent>\n      </AccordionItem>\n    </Accordion>\n  );\n};\n\nexport default DepositFeeBreakdown;\n",
      "type": "registry:component",
      "target": "components/deposit/components/fee-breakdown.tsx"
    },
    {
      "path": "registry/nexus-elements/deposit/components/transaction-progress.tsx",
      "content": "import { Check, LoaderPinwheel, Circle, Link as LinkIcon } from \"lucide-react\";\nimport React from \"react\";\nimport { type ProgressStep } from \"@avail-project/nexus-core\";\n\ninterface BridgeExecuteProgressProps {\n  timer: number;\n  steps: Array<{ id: number; completed: boolean; step: ProgressStep }>;\n  intentUrl?: string;\n  executeUrl?: string;\n}\n\nconst getOperationText = (type: string) => {\n  switch (type) {\n    case \"bridge\":\n      return \"Transaction\";\n    case \"transfer\":\n      return \"Transferring\";\n    case \"bridgeAndExecute\":\n      return \"Deposit\";\n    case \"swap\":\n      return \"Swapping\";\n    default:\n      return \"Processing\";\n  }\n};\n\nconst getStatusText = (type: string, operationType: string) => {\n  const opText = getOperationText(operationType);\n\n  switch (type) {\n    case \"INTENT_ACCEPTED\":\n      return \"Intent Accepted\";\n    case \"INTENT_HASH_SIGNED\":\n      return \"Signing Transaction\";\n    case \"INTENT_SUBMITTED\":\n      return \"Submitting Transaction\";\n    case \"INTENT_COLLECTION\":\n      return \"Collecting Confirmations\";\n    case \"INTENT_COLLECTION_COMPLETE\":\n      return \"Confirmations Complete\";\n    case \"APPROVAL\":\n      return \"Approving\";\n    case \"TRANSACTION_SENT\":\n      return \"Sending Transaction\";\n    case \"RECEIPT_RECEIVED\":\n      return \"Receipt Received\";\n    case \"TRANSACTION_CONFIRMED\":\n    case \"INTENT_FULFILLED\":\n      return `${opText} Complete`;\n    default:\n      return `Processing ${opText}`;\n  }\n};\n\nconst KNOWN_TYPES = new Set<string>([\n  \"INTENT_ACCEPTED\",\n  \"INTENT_HASH_SIGNED\",\n  \"INTENT_SUBMITTED\",\n  \"INTENT_COLLECTION\",\n  \"INTENT_COLLECTION_COMPLETE\",\n  \"APPROVAL\",\n  \"TRANSACTION_SENT\",\n  \"RECEIPT_RECEIVED\",\n  \"TRANSACTION_CONFIRMED\",\n  \"INTENT_FULFILLED\",\n]);\n\ntype DisplayStep = { id: string; label: string; completed: boolean };\n\nconst StepList: React.FC<{ steps: DisplayStep[]; currentIndex: number }> = ({\n  steps,\n  currentIndex,\n}) => {\n  return (\n    <div className=\"w-full mt-6 space-y-6\">\n      {steps.map((s, idx) => {\n        const isCompleted = !!s.completed;\n        const isCurrent = currentIndex === -1 ? false : idx === currentIndex;\n\n        let rightIcon = <Circle className=\"size-5 text-muted-foreground\" />;\n        if (isCompleted) {\n          rightIcon = <Check className=\"size-5 text-green-600\" />;\n        } else if (isCurrent) {\n          rightIcon = (\n            <LoaderPinwheel className=\"size-5 animate-spin text-muted-foreground\" />\n          );\n        }\n\n        return (\n          <div key={s.id} className=\"flex items-center justify-between w-full\">\n            <div className=\"flex items-center gap-x-3\">\n              <span className=\"text-base font-semibold\">{s.label}</span>\n            </div>\n            {rightIcon}\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nconst BridgeExecuteProgress: React.FC<BridgeExecuteProgressProps> = ({\n  timer,\n  steps,\n  intentUrl,\n  executeUrl,\n}) => {\n  const allCompleted = steps?.length > 0 && steps.every((s) => s.completed);\n\n  const operationType = \"bridgeAndExecute\";\n\n  const { effectiveSteps, currentIndex } = React.useMemo(() => {\n    const isCompleted = (type: string) =>\n      Array.isArray(steps) &&\n      steps.some((s) => s?.step?.type === type && s.completed);\n\n    const displaySteps: DisplayStep[] = [];\n    const seen = new Set<string>();\n\n    // Aggregate allowance progress across multiple chains\n    const allowanceRequiredChains = new Set<number | string>();\n    const allowanceMinedChains = new Set<number | string>();\n    let allowanceAllDoneCompleted = false;\n\n    const getChainIdFromStep = (st: any): number | string | undefined => {\n      const direct = st?.data?.chainID ?? st?.chainID;\n      if (direct !== undefined && direct !== null) return direct;\n      const typeID: string | undefined = st?.typeID;\n      if (typeof typeID === \"string\") {\n        const parts = typeID.split(\"_\");\n        const last = parts[parts.length - 1];\n        if (last) {\n          const num = Number(last);\n          return Number.isNaN(num) ? last : num;\n        }\n      }\n      return undefined;\n    };\n\n    const pushCombinedSignSubmit = () => {\n      if (seen.has(\"SIGN_SUBMIT\")) return;\n      const label = isCompleted(\"INTENT_HASH_SIGNED\")\n        ? \"Submitting Transaction\"\n        : \"Signing Transaction\";\n      const completed = isCompleted(\"INTENT_SUBMITTED\");\n      displaySteps.push({ id: \"SIGN_SUBMIT\", label, completed });\n      seen.add(\"SIGN_SUBMIT\");\n      seen.add(\"INTENT_HASH_SIGNED\");\n      seen.add(\"INTENT_SUBMITTED\");\n    };\n\n    const pushCombinedConfirmations = () => {\n      if (seen.has(\"CONFIRMATIONS\")) return;\n      const label = isCompleted(\"INTENT_COLLECTION\")\n        ? \"Confirmations Complete\"\n        : \"Collecting Confirmations\";\n      const completed = isCompleted(\"INTENT_COLLECTION_COMPLETE\");\n      displaySteps.push({ id: \"CONFIRMATIONS\", label, completed });\n      seen.add(\"CONFIRMATIONS\");\n      seen.add(\"INTENT_COLLECTION\");\n      seen.add(\"INTENT_COLLECTION_COMPLETE\");\n    };\n\n    const pushTransactionComplete = (type: string) => {\n      if (seen.has(\"TX_COMPLETE\")) return;\n      const completed =\n        isCompleted(\"TRANSACTION_CONFIRMED\") ||\n        isCompleted(\"INTENT_FULFILLED\") ||\n        isCompleted(type);\n      displaySteps.push({\n        id: \"TX_COMPLETE\",\n        label: getStatusText(\"INTENT_FULFILLED\", operationType),\n        completed,\n      });\n      seen.add(\"TX_COMPLETE\");\n    };\n\n    (steps ?? []).forEach((s) => {\n      const type = s?.step?.type as unknown as string;\n      if (!type || seen.has(type)) return;\n\n      // Collect ALLOWANCE_* steps into a single aggregated step later\n      if (type.startsWith(\"ALLOWANCE_\")) {\n        const chainId = getChainIdFromStep(s?.step as any);\n        if (type === \"ALLOWANCE_USER_APPROVAL\") {\n          if (chainId !== undefined) allowanceRequiredChains.add(chainId);\n          return;\n        }\n        if (type === \"ALLOWANCE_APPROVAL_MINED\") {\n          if (chainId !== undefined) {\n            allowanceRequiredChains.add(chainId);\n            if (s.completed) allowanceMinedChains.add(chainId);\n          }\n          return;\n        }\n        if (type === \"ALLOWANCE_ALL_DONE\") {\n          if (s.completed) allowanceAllDoneCompleted = true;\n          return;\n        }\n      }\n\n      if (type === \"INTENT_HASH_SIGNED\" || type === \"INTENT_SUBMITTED\") {\n        pushCombinedSignSubmit();\n        return;\n      }\n\n      if (\n        type === \"INTENT_COLLECTION\" ||\n        type === \"INTENT_COLLECTION_COMPLETE\"\n      ) {\n        pushCombinedConfirmations();\n        return;\n      }\n\n      if (type === \"TRANSACTION_CONFIRMED\" || type === \"INTENT_FULFILLED\") {\n        pushTransactionComplete(type);\n        return;\n      }\n\n      if (KNOWN_TYPES.has(type)) {\n        displaySteps.push({\n          id: type,\n          label: getStatusText(type, operationType),\n          completed: !!s.completed,\n        });\n        seen.add(type);\n      }\n    });\n\n    // Insert aggregated Allowances step before signing, or after intent accepted\n    const totalAllowances = new Set([\n      ...Array.from(allowanceRequiredChains.values()),\n      ...Array.from(allowanceMinedChains.values()),\n    ]).size;\n    if (totalAllowances > 0 || allowanceAllDoneCompleted) {\n      const allowancesCompleted = allowanceMinedChains.size;\n      const completed =\n        allowanceAllDoneCompleted ||\n        (totalAllowances > 0 && allowancesCompleted >= totalAllowances);\n      const label = completed\n        ? \"Allowances Complete\"\n        : `Setting allowances ${allowancesCompleted}/${totalAllowances}`;\n\n      let insertIdx = displaySteps.findIndex((st) => st.id === \"SIGN_SUBMIT\");\n      if (insertIdx === -1) {\n        const idxAccepted = displaySteps.findIndex(\n          (st) => st.id === \"INTENT_ACCEPTED\"\n        );\n        insertIdx = idxAccepted === -1 ? 0 : idxAccepted + 1;\n      }\n      displaySteps.splice(insertIdx, 0, {\n        id: \"ALLOWANCES\",\n        label,\n        completed,\n      });\n    }\n\n    let effective: DisplayStep[] = displaySteps;\n    if (!displaySteps.length) {\n      effective = allCompleted\n        ? []\n        : [\n            {\n              id: \"GENERIC\",\n              label: `Processing ${getOperationText(operationType)}`,\n              completed: false,\n            },\n          ];\n    }\n    const current = effective.findIndex((st) => !st.completed);\n\n    return { effectiveSteps: effective, currentIndex: current };\n  }, [steps, allCompleted]);\n\n  return (\n    <div className=\"w-full flex flex-col items-center\">\n      <div className=\"flex flex-col items-center gap-y-3\">\n        {allCompleted ? (\n          <Check className=\"size-6 text-green-600\" />\n        ) : (\n          <LoaderPinwheel className=\"size-6 animate-spin\" />\n        )}\n        <p>{allCompleted ? \"Deposit Completed\" : \"Processing your deposit\"}</p>\n        <div className=\"flex items-center justify-center w-full\">\n          <span className=\"text-2xl font-semibold\">{Math.floor(timer)}</span>\n          <span className=\"text-base font-semibold\">.</span>\n          <span className=\"text-base font-semibold\">\n            {String(Math.floor((timer % 1) * 1000)).padStart(3, \"0\")}s\n          </span>\n        </div>\n      </div>\n\n      <StepList steps={effectiveSteps} currentIndex={currentIndex} />\n\n      <div className=\"mt-6 w-full flex items-center justify-center gap-x-4\">\n        {intentUrl && (\n          <a\n            href={intentUrl}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            className=\"underline text-sm inline-flex items-center gap-x-1\"\n          >\n            <LinkIcon className=\"size-3\" /> View Intent\n          </a>\n        )}\n        {executeUrl && (\n          <a\n            href={executeUrl}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            className=\"underline text-sm inline-flex items-center gap-x-1\"\n          >\n            <LinkIcon className=\"size-3\" /> View Execute Tx\n          </a>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default BridgeExecuteProgress;\n",
      "type": "registry:component",
      "target": "components/deposit/components/transaction-progress.tsx"
    },
    {
      "path": "registry/nexus-elements/deposit/hooks/useDeposit.ts",
      "content": "\"use client\";\n\nimport {\n  type SUPPORTED_CHAINS_IDS,\n  type SUPPORTED_TOKENS,\n  type UserAsset,\n  NexusSDK,\n  type OnIntentHookData,\n  type OnAllowanceHookData,\n  type ExecuteParams,\n  type BridgeAndExecuteParams,\n  type BridgeAndExecuteResult,\n  BridgeAndExecuteSimulationResult,\n} from \"@avail-project/nexus-core\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\n\ninterface DepositInputs {\n  chain: SUPPORTED_CHAINS_IDS;\n  amount?: string;\n  selectedSources: number[];\n}\n\ntype ExecuteConfig = Omit<ExecuteParams, \"toChainId\">;\n\ninterface UseDepositProps {\n  chain: SUPPORTED_CHAINS_IDS;\n  nexusSDK: NexusSDK | null;\n  intent: OnIntentHookData | null;\n  setIntent: React.Dispatch<React.SetStateAction<OnIntentHookData | null>>;\n  allowance: OnAllowanceHookData | null;\n  setAllowance: React.Dispatch<\n    React.SetStateAction<OnAllowanceHookData | null>\n  >;\n  unifiedBalance: UserAsset[] | null;\n  chainOptions?: { id: number; name: string; logo: string }[];\n  executeConfig?: ExecuteConfig;\n}\n\nconst useDeposit = ({\n  chain,\n  nexusSDK,\n  intent,\n  setIntent,\n  allowance,\n  setAllowance,\n  unifiedBalance,\n  chainOptions,\n  executeConfig,\n}: UseDepositProps) => {\n  const { fetchUnifiedBalance } = useNexus();\n  const allSourceIds = useMemo(\n    () => chainOptions?.map((c) => c.id) ?? [],\n    [chainOptions]\n  );\n\n  const [inputs, setInputs] = useState<DepositInputs>({\n    chain,\n    amount: undefined,\n    selectedSources: allSourceIds,\n  });\n\n  useEffect(() => {\n    // keep default sources in sync if options change\n    setInputs((prev) => ({ ...prev, selectedSources: allSourceIds }));\n  }, [allSourceIds]);\n\n  const [timer, setTimer] = useState(0);\n  const [startTxn, setStartTxn] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [refreshing, setRefreshing] = useState(false);\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [txError, setTxError] = useState<string | null>(null);\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\n  const [simulation, setSimulation] =\n    useState<BridgeAndExecuteSimulationResult | null>(null);\n  const [simulating, setSimulating] = useState(false);\n  const [autoAllow, setAutoAllow] = useState(false);\n  const [lastResult, setLastResult] = useState<BridgeAndExecuteResult | null>(\n    null\n  );\n\n  useMemo(() => {\n    const hasChain = inputs?.chain !== undefined && inputs?.chain !== null;\n    const hasAmount = Boolean(inputs?.amount) && Number(inputs?.amount) > 0;\n    return hasChain && hasAmount;\n  }, [inputs]);\n\n  const filteredUnifiedBalance = useMemo(() => {\n    return unifiedBalance?.filter((bal) => bal?.symbol === \"USDC\")[0];\n  }, [unifiedBalance]);\n\n  const handleTransaction = async () => {\n    if (!inputs?.amount || !inputs?.chain) return;\n    setLoading(true);\n    setTxError(null);\n    try {\n      if (!nexusSDK) throw new Error(\"Nexus SDK not initialized\");\n\n      const params: BridgeAndExecuteParams = {\n        token: \"USDC\" as SUPPORTED_TOKENS,\n        amount: inputs.amount,\n        toChainId: inputs.chain,\n        sourceChains: inputs.selectedSources?.length\n          ? inputs.selectedSources\n          : allSourceIds,\n        execute: executeConfig,\n        waitForReceipt: true,\n      };\n\n      const result: BridgeAndExecuteResult = await nexusSDK.bridgeAndExecute(\n        params\n      );\n      console.log(\"result\", result);\n\n      if (!result?.success) {\n        setTxError(result?.error || \"Transaction rejected by user\");\n        setIsDialogOpen(false);\n        resetState();\n        return;\n      }\n      setLastResult(result);\n      await onSuccess();\n    } catch (error) {\n      const msg = (error as Error)?.message || \"Transaction failed\";\n      setTxError(\n        msg.includes(\"User rejected\") ? \"User rejected the transaction\" : msg\n      );\n      setIsDialogOpen(false);\n    } finally {\n      resetState();\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n    }\n  };\n\n  const simulate = async (overrideAmount?: string) => {\n    if (!nexusSDK) return;\n    const amountToUse = overrideAmount ?? inputs?.amount;\n    if (!amountToUse || !inputs?.chain) {\n      setSimulation(null);\n      return;\n    }\n    setSimulating(true);\n    try {\n      const params: BridgeAndExecuteParams = {\n        token: \"USDC\" as SUPPORTED_TOKENS,\n        amount: amountToUse,\n        toChainId: inputs.chain,\n        sourceChains: inputs.selectedSources?.length\n          ? inputs.selectedSources\n          : allSourceIds,\n        execute: executeConfig,\n        waitForReceipt: false,\n      };\n      console.log(\"simulation params\", params);\n      const sim = await nexusSDK.simulateBridgeAndExecute(params);\n      console.log(\"simulation result\", sim);\n      if (sim?.success) {\n        setTxError(null);\n        setSimulation(sim);\n      } else {\n        setSimulation(null);\n        setTxError(sim?.error || \"Simulation failed\");\n      }\n    } catch (error) {\n      const msg = (error as Error)?.message || \"Simulation failed\";\n      setSimulation(null);\n      setTxError(\n        msg.includes(\"User rejected\") ? \"User rejected the simulation\" : msg\n      );\n    } finally {\n      setSimulating(false);\n    }\n  };\n\n  const onSuccess = async () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n    await fetchUnifiedBalance();\n  };\n\n  const resetState = () => {\n    setIntent(null);\n    setAllowance(null);\n    setInputs({\n      chain,\n      amount: undefined,\n      selectedSources: allSourceIds,\n    });\n    setLoading(false);\n    setStartTxn(false);\n    setRefreshing(false);\n    setSimulation(null);\n    setIntent(null);\n  };\n\n  const reset = () => {\n    intent?.deny();\n    resetState();\n  };\n\n  const startTransaction = () => {\n    setTimer(0);\n    setStartTxn(true);\n    setIsDialogOpen(true);\n    setTxError(null);\n    setAutoAllow(true);\n    void handleTransaction();\n  };\n\n  useEffect(() => {\n    if (autoAllow && intent) {\n      intent.allow();\n      setAutoAllow(false);\n    }\n  }, [autoAllow, intent]);\n\n  useEffect(() => {\n    if (startTxn) {\n      timerRef.current = setInterval(() => setTimer((prev) => prev + 0.1), 100);\n    }\n    return () => {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n    };\n  }, [startTxn]);\n\n  useEffect(() => {\n    if (!isDialogOpen) {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      setStartTxn(false);\n      setLastResult(null);\n    }\n  }, [isDialogOpen]);\n\n  // Do not auto-clear txError on input changes. It is cleared explicitly\n  // when a new simulate/transaction starts or succeeds.\n\n  const stopTimer = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n    setStartTxn(false);\n  };\n\n  return {\n    inputs,\n    setInputs,\n    loading,\n    simulating,\n    refreshing,\n    isDialogOpen,\n    setIsDialogOpen,\n    txError,\n    setTxError,\n    timer,\n    filteredUnifiedBalance,\n    simulation,\n    lastResult,\n    handleTransaction,\n    startTransaction,\n    reset,\n    stopTimer,\n    simulate,\n    clearSimulation: () => reset(),\n  };\n};\n\nexport default useDeposit;\n",
      "type": "registry:component",
      "target": "components/deposit/hooks/useDeposit.ts"
    },
    {
      "path": "registry/nexus-elements/ui/checkbox.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { CheckIcon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Checkbox({\n  className,\n  ...props\n}: React.ComponentProps<typeof CheckboxPrimitive.Root>) {\n  return (\n    <CheckboxPrimitive.Root\n      data-slot=\"checkbox\"\n      className={cn(\n        \"peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <CheckboxPrimitive.Indicator\n        data-slot=\"checkbox-indicator\"\n        className=\"grid place-content-center text-current transition-none\"\n      >\n        <CheckIcon className=\"size-3.5\" />\n      </CheckboxPrimitive.Indicator>\n    </CheckboxPrimitive.Root>\n  )\n}\n\nexport { Checkbox }\n",
      "type": "registry:component",
      "target": "components/ui/checkbox.tsx"
    },
    {
      "path": "registry/nexus-elements/ui/popover.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Popover({\n  ...props\n}: React.ComponentProps<typeof PopoverPrimitive.Root>) {\n  return <PopoverPrimitive.Root data-slot=\"popover\" {...props} />\n}\n\nfunction PopoverTrigger({\n  ...props\n}: React.ComponentProps<typeof PopoverPrimitive.Trigger>) {\n  return <PopoverPrimitive.Trigger data-slot=\"popover-trigger\" {...props} />\n}\n\nfunction PopoverContent({\n  className,\n  align = \"center\",\n  sideOffset = 4,\n  ...props\n}: React.ComponentProps<typeof PopoverPrimitive.Content>) {\n  return (\n    <PopoverPrimitive.Portal>\n      <PopoverPrimitive.Content\n        data-slot=\"popover-content\"\n        align={align}\n        sideOffset={sideOffset}\n        className={cn(\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden\",\n          className\n        )}\n        {...props}\n      />\n    </PopoverPrimitive.Portal>\n  )\n}\n\nfunction PopoverAnchor({\n  ...props\n}: React.ComponentProps<typeof PopoverPrimitive.Anchor>) {\n  return <PopoverPrimitive.Anchor data-slot=\"popover-anchor\" {...props} />\n}\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n",
      "type": "registry:component",
      "target": "components/ui/popover.tsx"
    },
    {
      "path": "registry/nexus-elements/fast-bridge/hooks/useListenTransaction.ts",
      "content": "import {\n  NEXUS_EVENTS,\n  NexusSDK,\n  type ProgressStep,\n} from \"@avail-project/nexus-core\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\n\ntype ProcessingState = Array<{\n  id: number;\n  completed: boolean;\n  step: ProgressStep;\n}>;\n\nconst useListenTransaction = (\n  sdk: NexusSDK | null,\n  transactionType: \"bridge\" | \"transfer\" | \"bridgeAndExecute\" = \"bridge\"\n) => {\n  const [processing, setProcessing] = useState<ProcessingState>([]);\n  const [explorerUrl, setExplorerUrl] = useState(\"\");\n  const [latestCompleted, setLatestCompleted] = useState<ProgressStep | null>(\n    null\n  );\n\n  useEffect(() => {\n    if (!sdk) return;\n\n    const completedIds = new Set<string>();\n    const firstEmissionRef = { current: true } as const;\n    let rafId: number | null = null;\n\n    const handleExpectedSteps = (expectedSteps: ProgressStep[]) => {\n      console.log(\"expected steps\", expectedSteps);\n      const stepsArray = Array.isArray(expectedSteps) ? expectedSteps : [];\n      const apply = () =>\n        setProcessing((prev) => {\n          prev.forEach((s) => {\n            if (s?.completed && s?.step?.typeID)\n              completedIds.add(s.step.typeID);\n          });\n          const next: ProcessingState = stepsArray.map((step, index) => ({\n            id: index,\n            completed: completedIds.has(step?.typeID ?? \"\"),\n            step,\n          }));\n          return next;\n        });\n\n      if (firstEmissionRef.current) {\n        // @ts-expect-error - mutating readonly-like for local pattern\n        firstEmissionRef.current = false;\n        apply();\n      } else {\n        if (rafId) cancelAnimationFrame(rafId);\n        rafId = requestAnimationFrame(apply);\n      }\n    };\n\n    const handleStepComplete = (stepData: ProgressStep) => {\n      console.log(\"completed stepData\", stepData);\n      if (stepData?.typeID) completedIds.add(stepData.typeID);\n      setProcessing((prev) =>\n        prev.map((s) =>\n          s.step && s.step.typeID === stepData?.typeID\n            ? { ...s, completed: true }\n            : s\n        )\n      );\n\n      setLatestCompleted(stepData);\n\n      if (\n        stepData?.typeID === \"IS\" &&\n        stepData?.data &&\n        \"explorerURL\" in stepData.data\n      ) {\n        setExplorerUrl(stepData?.data?.explorerURL);\n      }\n    };\n    const exepectedEvent =\n      transactionType === \"bridgeAndExecute\"\n        ? NEXUS_EVENTS.BRIDGE_EXECUTE_EXPECTED_STEPS\n        : NEXUS_EVENTS.EXPECTED_STEPS;\n    const completeEvent =\n      transactionType === \"bridgeAndExecute\"\n        ? NEXUS_EVENTS.BRIDGE_EXECUTE_COMPLETED_STEPS\n        : NEXUS_EVENTS.STEP_COMPLETE;\n    sdk?.nexusEvents?.on(exepectedEvent, handleExpectedSteps);\n    sdk?.nexusEvents?.on(completeEvent, handleStepComplete);\n    return () => {\n      sdk?.nexusEvents?.off(exepectedEvent, handleExpectedSteps);\n      sdk?.nexusEvents?.off(completeEvent, handleStepComplete);\n      if (rafId) cancelAnimationFrame(rafId);\n    };\n  }, [sdk]);\n\n  const latestCompletedIndex = useMemo(() => {\n    if (!processing?.length) return -1;\n    for (let i = processing.length - 1; i >= 0; i -= 1) {\n      if (processing[i]?.completed) return i;\n    }\n    return -1;\n  }, [processing]);\n\n  return { processing, latestCompleted, latestCompletedIndex, explorerUrl };\n};\n\nexport default useListenTransaction;\n",
      "type": "registry:component",
      "target": "components/fast-bridge/hooks/useListenTransaction.ts"
    },
    {
      "path": "registry/nexus-elements/fast-bridge/components/allowance-modal.tsx",
      "content": "\"use client\";\nimport React, { FC, useEffect, useState } from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"../../ui/dialog\";\nimport { Button } from \"../../ui/button\";\nimport { Input } from \"../../ui/input\";\nimport { Label } from \"../../ui/label\";\nimport {\n  type AllowanceHookSource,\n  CHAIN_METADATA,\n  type OnAllowanceHookData,\n} from \"@avail-project/nexus-core\";\nimport { useNexus } from \"../../nexus/NexusProvider\";\n\ninterface AllowanceModalProps {\n  allowanceModal: OnAllowanceHookData | null;\n  setAllowanceModal: React.Dispatch<\n    React.SetStateAction<OnAllowanceHookData | null>\n  >;\n  callback?: () => void;\n}\n\nconst AllowanceModal: FC<AllowanceModalProps> = ({\n  allowanceModal,\n  setAllowanceModal,\n  callback,\n}) => {\n  const { nexusSDK } = useNexus();\n  const [selectedOption, setSelectedOption] = useState<string[]>([]);\n  const [customValues, setCustomValues] = useState<string[]>([]);\n\n  useEffect(() => {\n    if (allowanceModal) {\n      setSelectedOption(\n        Array.from({ length: allowanceModal.sources.length }, () => \"min\")\n      );\n      setCustomValues(\n        Array.from({ length: allowanceModal.sources.length }, () => \"\")\n      );\n    }\n  }, [allowanceModal]);\n\n  if (!allowanceModal) return null;\n\n  const { sources, allow, deny } = allowanceModal;\n\n  const onClose = () => {\n    deny();\n    setAllowanceModal(null);\n  };\n\n  const onApprove = () => {\n    const processed = sources.map((_, i) => {\n      const opt = selectedOption[i];\n      if (opt === \"min\" || opt === \"max\") return opt;\n      const v = customValues[i];\n      if (v && !isNaN(Number(v))) return v;\n      return \"min\";\n    });\n    try {\n      allow(processed);\n      setAllowanceModal(null);\n      callback?.();\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  return (\n    <Dialog\n      open={!!allowanceModal}\n      onOpenChange={(isOpen) => !isOpen && onClose()}\n    >\n      <DialogContent className=\"w-full sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle>Set Token Allowances</DialogTitle>\n          <DialogDescription>\n            Select minimum, maximum, or a custom allowance for each required\n            token.\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 py-2 max-h-[60vh] overflow-y-auto\">\n          {sources?.map((source: AllowanceHookSource, index: number) => (\n            <div\n              key={`${source.token.symbol}-${index}`}\n              className=\"p-3 border rounded-lg\"\n            >\n              <div className=\"flex items-center justify-between gap-x-2\">\n                <div className=\"flex items-center gap-x-2\">\n                  <img\n                    src={CHAIN_METADATA[source.chain.id]?.logo}\n                    alt={source.chain.name}\n                    width={20}\n                    height={20}\n                    className=\"rounded-full\"\n                  />\n                  <p className=\"font-semibold\">\n                    {source.token.symbol} on {source.chain.name}\n                  </p>\n                </div>\n                <div className=\"text-sm\">\n                  <span className=\"mr-1 text-muted-foreground\">Current:</span>\n                  <span className=\"font-semibold\">\n                    {nexusSDK?.utils.formatBalance(\n                      source.allowance.current,\n                      source.token.decimals\n                    )}\n                  </span>\n                </div>\n              </div>\n\n              <div className=\"mt-3 grid grid-cols-1 gap-2\">\n                <Label className=\"flex items-center gap-x-2\">\n                  <Input\n                    type=\"radio\"\n                    name={`allowance-${index}`}\n                    value=\"min\"\n                    checked={selectedOption[index] === \"min\"}\n                    onChange={() => {\n                      const next = [...selectedOption];\n                      next[index] = \"min\";\n                      setSelectedOption(next);\n                    }}\n                    className=\"w-10\"\n                  />\n                  <span>\n                    Minimum (\n                    {nexusSDK?.utils.formatBalance(\n                      source.allowance.minimum,\n                      source.token.decimals\n                    )}\n                    )\n                  </span>\n                </Label>\n\n                <Label className=\"flex items-center gap-x-2\">\n                  <Input\n                    type=\"radio\"\n                    name={`allowance-${index}`}\n                    value=\"max\"\n                    checked={selectedOption[index] === \"max\"}\n                    onChange={() => {\n                      const next = [...selectedOption];\n                      next[index] = \"max\";\n                      setSelectedOption(next);\n                    }}\n                    className=\"w-10\"\n                  />\n                  <span>Maximum (Unlimited)</span>\n                </Label>\n\n                <div className=\"flex items-center gap-x-2\">\n                  <Input\n                    type=\"radio\"\n                    name={`allowance-${index}`}\n                    value=\"custom\"\n                    checked={selectedOption[index] === \"custom\"}\n                    onChange={() => {\n                      const next = [...selectedOption];\n                      next[index] = \"custom\";\n                      setSelectedOption(next);\n                    }}\n                    className=\"w-10\"\n                  />\n                  <Label className=\"mr-2\">Custom Amount</Label>\n                  <Input\n                    type=\"number\"\n                    step=\"any\"\n                    min=\"0\"\n                    placeholder=\"Enter custom amount\"\n                    value={\n                      selectedOption[index] === \"custom\"\n                        ? customValues[index]\n                        : \"\"\n                    }\n                    onChange={(e) => {\n                      const next = [...customValues];\n                      next[index] = e.target.value;\n                      setCustomValues(next);\n                    }}\n                    className=\"h-8 w-40\"\n                  />\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n\n        <DialogFooter className=\"gap-2 sm:justify-end mt-2\">\n          <Button\n            variant=\"destructive\"\n            onClick={onClose}\n            className=\"font-semibold\"\n          >\n            Deny\n          </Button>\n          <Button onClick={onApprove} className=\"font-semibold\">\n            Approve Selected\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default AllowanceModal;\n",
      "type": "registry:component",
      "target": "components/fast-bridge/components/allowance-modal.tsx"
    },
    {
      "path": "registry/nexus-elements/fast-bridge/components/source-breakdown.tsx",
      "content": "import {\n  type ReadableIntent,\n  type SUPPORTED_TOKENS,\n} from \"@avail-project/nexus-core\";\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"../../ui/accordion\";\n\ninterface SourceBreakdownProps {\n  intent: ReadableIntent;\n  tokenSymbol: SUPPORTED_TOKENS;\n}\n\nconst SourceBreakdown = ({ intent, tokenSymbol }: SourceBreakdownProps) => {\n  return (\n    <Accordion type=\"single\" collapsible className=\"w-full\">\n      <AccordionItem value=\"sources\">\n        <div className=\"flex items-start justify-between gap-x-4 w-full\">\n          {intent?.sources && (\n            <>\n              <div className=\"flex flex-col items-start gap-y-1 min-w-fit\">\n                <p className=\"text-base font-semibold\">You Spend</p>\n                <p className=\"text-sm font-medium\">\n                  {intent?.sources?.length > 1\n                    ? `${intent?.sources?.length} Assets on ${intent?.sources?.length} chains`\n                    : `${intent?.sources?.length} asset on ${intent?.sources?.length} chain`}\n                </p>\n              </div>\n\n              <div className=\"flex flex-col items-end gap-y-1 min-w-fit\">\n                <p className=\"text-base font-semibold\">\n                  {intent?.sourcesTotal} {tokenSymbol}\n                </p>\n                <AccordionTrigger\n                  containerClassName=\"w-fit\"\n                  className=\"py-0 items-center gap-x-1\"\n                  hideChevron={false}\n                >\n                  <p className=\"text-sm font-medium\">View Sources</p>\n                </AccordionTrigger>\n              </div>\n            </>\n          )}\n        </div>\n        {intent?.sources && (\n          <AccordionContent className=\"my-4 bg-muted pb-0 px-4 py-2 rounded-lg w-full\">\n            <div className=\"flex flex-col items-center gap-y-3\">\n              {intent?.sources?.map((source) => (\n                <div\n                  key={source.chainID}\n                  className=\"flex items-center justify-between w-full gap-x-2\"\n                >\n                  <div className=\"flex items-center gap-x-2\">\n                    <img\n                      src={source?.chainLogo}\n                      alt={source?.chainName}\n                      width={20}\n                      height={20}\n                      className=\"rounded-full\"\n                    />\n                    <p className=\"text-sm font-semibold\">{source.chainName}</p>\n                  </div>\n\n                  <p className=\"text-sm font-semibold\">\n                    {source.amount} {tokenSymbol}\n                  </p>\n                </div>\n              ))}\n            </div>\n          </AccordionContent>\n        )}\n      </AccordionItem>\n    </Accordion>\n  );\n};\n\nexport default SourceBreakdown;\n",
      "type": "registry:component",
      "target": "components/fast-bridge/components/source-breakdown.tsx"
    }
  ]
}