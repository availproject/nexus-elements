---
title: Deposit
description: A Plug and Play Deposit Widget with Unified Balances. Aggregate and swap multiple tokens across 10+ chains to deposit as any desired token on any chain and address.
component: true
links:
  doc: https://docs.availproject.org/nexus/avail-nexus-sdk/bridge-methods/bridge-and-execute
  api: https://docs.availproject.org/nexus/avail-nexus-sdk/api-reference#execute-operations
---

## Preview

<ComponentPreview
  name="deposit"
  description="A deposit flow with source breakdown, allowance, and embedded/modal views."
  align="center"
  className="[&_.preview>[data-orientation=vertical]]:sm:max-w-[80%] **:[.preview]:min-h-[400px]"
  chromeLessOnMobile={true}
/>

## Features

- **Unified Balance Aggregation**: Automatically aggregates user balances across multiple chains
- **Smart Swap Detection**: Detects when a swap is needed vs. using existing balance on destination chain
- **Swap Skip Optimization**: When user has sufficient balance on destination chain, skips the swap phase entirely for faster execution
- **Customizable Execute Builder**: Define custom protocol interactions (e.g., Aave supply, Compound deposit)
- **Real-time Fee Estimation**: Shows gas fees and protocol fees before confirmation
- **Multi-step Progress Tracking**: Visual feedback during transaction execution

## Installation

<CodeTabs>
  <TabsList>
    <TabsTrigger value="cli">CLI</TabsTrigger>
    <TabsTrigger value="manual">Manual</TabsTrigger>
  </TabsList>
  <TabsContent value="cli">
```bash
npx shadcn@latest add @nexus-elements/deposit
```

  </TabsContent>
  <TabsContent value="manual">
    <Steps>
      <Step>Install these dependencies</Step>
```bash
npm install @avail-project/nexus-core@1.1.0 lucide-react @radix-ui/react-dialog @radix-ui/react-collapsible @radix-ui/react-accordion @radix-ui/react-label @radix-ui/react-popover @radix-ui/react-checkbox @radix-ui/react-slot @radix-ui/react-tooltip
```
      <Step>Copy and paste the following code into your project.</Step>
      <div
        data-slot="code"
        className="my-4 overflow-y-hidden overflow-x-scroll sm:overflow-hidden **:data-rehype-pretty-code-figure:m-0! **:data-rehype-pretty-code-figure:rounded-t-none **:data-rehype-pretty-code-figure:border-t [&_pre]:max-h-[400px]"
      >
        <ComponentSource name="deposit" showAllFiles />
      </div>
      <Step>Update the import paths to match your project setup.</Step>
    </Steps>
  </TabsContent>
</CodeTabs>

## Usage

<Step className="font-serif text-lg">
  Don't forget to wrap your app with NexusProvider
</Step>
<Step className="font-serif text-base">
  View Detailed instructions{" "}
  <a href="/docs/get-started" target="_blank" className="underline">
    here
  </a>
</Step>

### Basic Usage

```tsx showLineNumbers
import { useState } from "react";
import NexusDeposit from "@/components/deposit/nexus-deposit";
import {
  SUPPORTED_CHAINS,
  TOKEN_CONTRACT_ADDRESSES,
  TOKEN_METADATA,
  CHAIN_METADATA,
} from "@avail-project/nexus-core";
import { encodeFunctionData, type Abi } from "viem";

function DepositExample() {
  const [isOpen, setIsOpen] = useState(false);

  return (
    <>
      <button onClick={() => setIsOpen(true)}>Open Deposit</button>
      <NexusDeposit
        open={isOpen}
        onOpenChange={setIsOpen}
        destination={{
          chainId: SUPPORTED_CHAINS.BASE,
          tokenAddress: TOKEN_CONTRACT_ADDRESSES["USDC"][SUPPORTED_CHAINS.BASE],
          tokenSymbol: "USDC",
          tokenDecimals: TOKEN_METADATA["USDC"].decimals,
          tokenLogo: TOKEN_METADATA["USDC"].icon,
          label: "Deposit USDC on Aave Base",
          gasTokenSymbol:
            CHAIN_METADATA[SUPPORTED_CHAINS.BASE].nativeCurrency.symbol,
          estimatedTime: "≈ 30s",
          explorerUrl: CHAIN_METADATA[SUPPORTED_CHAINS.BASE].blockExplorerUrls[0],
          depositTargetLogo: 'path/to/dapp/logo'
        }}
        executeDeposit={(tokenSymbol, tokenAddress, amount, _chainId, user) => {
          const contractAddress =
            "0xA238Dd80C259a72e81d7e4664a9801593F98d1c5" as const;
          const abi: Abi = [
            {
              inputs: [
                { internalType: "address", name: "asset", type: "address" },
                { internalType: "uint256", name: "amount", type: "uint256" },
                { internalType: "address", name: "onBehalfOf", type: "address" },
                { internalType: "uint16", name: "referralCode", type: "uint16" },
              ],
              name: "supply",
              outputs: [],
              stateMutability: "nonpayable",
              type: "function",
            },
          ];

          const encoded = encodeFunctionData({
            abi: abi,
            functionName: "supply",
            args: [tokenAddress, amount, user, 0],
          });

          return {
            to: contractAddress,
            data: encoded,
            tokenApproval: {
              token: tokenSymbol,
              amount: amount,
              spender: contractAddress,
            },
          };
        }}
      />
    </>
  );
}
```

### Embedded Mode

Use `embed={true}` to render the widget inline within a card instead of as a modal:

```tsx showLineNumbers
<NexusDeposit
  embed={true}
  heading="Deposit to Aave"
  destination={{...}}
  executeDeposit={(tokenSymbol, tokenAddress, amount, chainId, user) => {
    // Your execute builder logic
  }}
/>
```

### With Callbacks

Handle success and error events:

```tsx showLineNumbers
<NexusDeposit
  destination={{...}}
  executeDeposit={(tokenSymbol, tokenAddress, amount, chainId, user) => {
    // Your execute builder logic
  }}
  onSuccess={() => {
    console.log("Deposit successful!");
    // Refresh balances, show notification, etc.
  }}
  onError={(error) => {
    console.error("Deposit failed:", error);
    // Handle error, show notification, etc.
  }}
  onClose={() => {
    console.log("Widget closed");
  }}
/>
```

### Modal Mode (Controlled)

When `embed={false}` (default), the widget renders as a modal dialog. You can control its open state:

```tsx showLineNumbers
import { useState } from "react";

function DepositPage() {
  const [isOpen, setIsOpen] = useState(false);

  return (
    <>
      <button onClick={() => setIsOpen(true)}>
        Open Deposit
      </button>

      <NexusDeposit
        open={isOpen}
        onOpenChange={setIsOpen}
        destination={{...}}
        executeDeposit={(tokenSymbol, tokenAddress, amount, chainId, user) => {
          // Your execute builder logic
        }}
        onSuccess={() => {
          setIsOpen(false);
          // Show success notification
        }}
      />
    </>
  );
}
```

For uncontrolled usage, use `defaultOpen`:

```tsx showLineNumbers
<NexusDeposit
  defaultOpen={true}
  destination={{...}}
  executeDeposit={...}
/>
```

## Transaction Flow

The deposit widget follows this flow:

### Normal Flow (Cross-chain Swap Required)
1. **Amount Input** → User enters the amount to deposit
2. **Confirmation** → User reviews fees, sources, and confirms
3. **Transaction Status** → Shows progress (Intent Verification → Collecting on Source → Deposit Transaction)
4. **Transaction Complete** → Shows success with explorer links

### Optimized Flow (Swap Skipped)
When the user has sufficient balance on the destination chain, the swap phase is skipped:

1. **Amount Input** → User enters the amount to deposit
2. **Transaction Status** → Shows single "Deposit Transaction" step
3. **Transaction Complete** → Shows success with deposit transaction link

This optimization reduces gas costs and transaction time when no cross-chain bridging is needed.

## API Reference

### NexusDeposit

The main component that orchestrates the deposit flow.

<CodeCollapsibleWrapper className="mt-4">

```ts title="DepositWidgetProps"
interface DepositWidgetProps {
  // Display options
  heading?: string;           // Card heading (default: "Deposit USDC")
  embed?: boolean;            // Render as embedded card vs modal (default: false)
  className?: string;         // Additional CSS classes

  // Destination configuration (required)
  destination: DestinationConfig;

  // Execute builder function (required)
  executeDeposit: (
    tokenSymbol: string,
    tokenAddress: string,
    amount: bigint,
    chainId: number,
    user: `0x${string}`
  ) => Omit<ExecuteParams, "toChainId">;

  // Callbacks
  onSuccess?: () => void;     // Called when deposit succeeds
  onError?: (error: string) => void;  // Called when deposit fails
  onClose?: () => void;       // Called when widget is closed

  // Dialog control (non-embed mode only)
  open?: boolean;             // Controlled open state
  onOpenChange?: (open: boolean) => void;  // Called when open state changes
  defaultOpen?: boolean;      // Default open state for uncontrolled usage
}
```

</CodeCollapsibleWrapper>

### DestinationConfig

Configuration for the deposit destination.

<CodeCollapsibleWrapper className="mt-4">

```ts title="DestinationConfig"
interface DestinationConfig {
  chainId: SUPPORTED_CHAINS_IDS;     // Destination chain ID
  tokenAddress: `0x${string}`;        // Token contract address
  tokenSymbol: string;                // Token symbol (e.g., "USDC")
  tokenDecimals: number;              // Token decimals (e.g., 6)
  tokenLogo?: string;                 // Token logo URL
  label?: string;                     // Custom label (e.g., "Deposit to Aave")
  estimatedTime?: string;             // Estimated time (e.g., "≈ 30s")
  gasTokenSymbol?: string;            // Gas token symbol (e.g., "ETH")
  explorerUrl?: string;               // Block explorer base URL
  depositTargetLogo?: string          // Logo of the dapp where deposit is happening
}
```

</CodeCollapsibleWrapper>

### ExecuteParams (Return Type)

The object returned by `executeDeposit` function.

<CodeCollapsibleWrapper className="mt-4">

```ts title="ExecuteParams"
interface ExecuteParams {
  to: `0x${string}`;          // Contract address to call
  data: `0x${string}`;        // Encoded function data
  value?: bigint;             // Native token value (optional)
  tokenApproval?: {           // Token approval config (optional)
    token: string;
    amount: bigint;
    spender: `0x${string}`;
  };
}
```

</CodeCollapsibleWrapper>

## Customization

### Styling

The component uses Tailwind CSS classes and can be customized via the `className` prop:

```tsx
<NexusDeposit
  className="max-w-lg shadow-xl"
  destination={{...}}
  executeDeposit={...}
/>
```

### Custom Protocol Integration

The `executeDeposit` function allows integration with any protocol. Here's an example for different protocols:

**Compound V3 Supply:**
```tsx
executeDeposit={(tokenSymbol, tokenAddress, amount, chainId, user) => {
  const compoundComet = "0xc3d688B66703497DAA19211EEdff47f25384cdc3";
  const encoded = encodeFunctionData({
    abi: cometAbi,
    functionName: "supply",
    args: [tokenAddress, amount],
  });
  return {
    to: compoundComet,
    data: encoded,
    tokenApproval: { token: tokenSymbol, amount, spender: compoundComet },
  };
}}
```

**Custom Vault Deposit:**
```tsx
executeDeposit={(tokenSymbol, tokenAddress, amount, chainId, user) => {
  const vaultAddress = "0x...";
  const encoded = encodeFunctionData({
    abi: vaultAbi,
    functionName: "deposit",
    args: [amount, user],
  });
  return {
    to: vaultAddress,
    data: encoded,
    tokenApproval: { token: tokenSymbol, amount, spender: vaultAddress },
  };
}}
```

## Hook Usage

For advanced use cases, you can use the underlying hook directly:

```tsx
import { useDepositWidget } from "@/components/deposit/hooks/use-deposit-widget";

function CustomDeposit() {
  const widget = useDepositWidget({
    destination: {...},
    executeDeposit: (...) => {...},
    onSuccess: () => console.log("Success!"),
    onError: (err) => console.error(err),
  });

  return (
    <div>
      <p>Step: {widget.step}</p>
      <p>Status: {widget.status}</p>
      <p>Balance: ${widget.totalBalance?.usdBalance}</p>
      {widget.skipSwap && <p>Using existing balance (no swap needed)</p>}
    </div>
  );
}
```

### Hook Return Values

| Property | Type | Description |
|----------|------|-------------|
| `step` | `WidgetStep` | Current step in the flow |
| `status` | `TransactionStatus` | Current transaction status |
| `skipSwap` | `boolean` | Whether swap phase is being skipped |
| `confirmationDetails` | `object \| null` | Fee breakdown and source details |
| `feeBreakdown` | `object` | Gas fee information |
| `totalBalance` | `object` | User's total balance across chains |
| `goToStep` | `function` | Navigate to a specific step |
| `goBack` | `function` | Go back to previous step |
| `reset` | `function` | Reset the widget state |
| `handleConfirmOrder` | `function` | Confirm and execute the deposit |
